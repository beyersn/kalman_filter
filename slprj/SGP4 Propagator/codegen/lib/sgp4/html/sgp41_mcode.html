<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">% -----------------------------------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%                              procedure sgp4</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%  this procedure is the sgp4 prediction model from space command. this is an</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%    updated and combined version of sgp4 and sdp4, which were originally</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%    published separately in spacetrack report #3. this version follows the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%    methodology from the aiaa paper (2006) describing the history and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%    development of the code.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% Author:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   Jeff Beck</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   beckja@alumni.lehigh.edu</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%    current :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%               7 may 08  david vallado</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%                           update small eccentricity check</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%    changes :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%              16 nov 07  david vallado</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%                           misc fixes for better compliance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%   1.0 (aug 7, 2006) - update for paper dav</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% original comments from Vallado C++ version:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%   author        : david vallado                  719-573-2600   28 jun 2005</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%   inputs        :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%     satrec    - initialised structure from sgp4init() call.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%     tsince    - time eince epoch (minutes)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%   outputs       :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%     r           - position vector                     km</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%     v           - velocity                            km/sec</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%     return code - non-zero on error.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%                    1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%                    2 - mean motion less than 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%                    3 - pert elements, ecc &lt; 0.0  or  ecc &gt; 1.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%                    4 - semi-latus rectum &lt; 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%                    5 - epoch elements are sub-orbital</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%                    6 - satellite has decayed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%   locals        :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%     am          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%     axnl, aynl        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%     betal       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%     COSIM   , SINIM   , COSOMM  , SINOMM  , Cnod    , Snod    , Cos2u   ,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%     Sin2u   , Coseo1  , Sineo1  , Cosi    , Sini    , Cosip   , Sinip   ,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%     Cosisq  , Cossu   , Sinsu   , Cosu    , Sinu</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%     Delm        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%     Delomg      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%     Dndt        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%     Eccm        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%     EMSQ        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%     Ecose       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%     El2         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%     Eo1         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%     Eccp        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%     Esine       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%     Argpm       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%     Argpp       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%     Omgadf      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%     Pl          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%     R           -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%     RTEMSQ      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">%     Rdotl       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%     Rl          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%     Rvdot       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%     Rvdotl      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%     Su          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">%     T2  , T3   , T4    , Tc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%     Tem5, Temp , Temp1 , Temp2  , Tempa  , Tempe  , Templ</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%     U   , Ux   , Uy    , Uz     , Vx     , Vy     , Vz</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%     inclm       - inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%     mm          - mean anomaly</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%     nm          - mean motion</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%     nodem      - longi of ascending node</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">%     xinc        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%     xincp       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%     xl          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">%     xlm         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%     mp          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">%     xmdf        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">%     xmx         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">%     xmy         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%     nodedf     -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">%     xnode       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">%     nodep      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">%     np          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%   coupling      :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">%     getgravconst</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%     dpper</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">%     dspace</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%   references    :</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%     hoots, roehrich, norad spacetrack report #3 1980</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">%     hoots, norad spacetrack report #6 1986</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="comment">%     hoots, schumacher and glover 2004</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="comment">%     vallado, crawford, hujsak, kelso  2006</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="comment">%  ----------------------------------------------------------------------------*/</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T18U3">r</span> = sgp4(<span class="var type1" id="S3T2U6">tsince</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T16:U3"><span class="var type1" id="S2T16U9">r</span> = <span class="mxinfo" id="T16:U5">[<span class="mxinfo" id="T2:U6">0</span> <span class="mxinfo" id="T2:U7">0</span> <span class="mxinfo" id="T2:U8">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">%% Define Constants</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo" id="T2:U9"><span class="var type1" id="S4T2U17">twopi</span> = <span class="mxinfo" id="T2:U11">2.0 * pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo" id="T2:U12"><span class="var type1" id="S6T2U24">x2o3</span>  = <span class="mxinfo" id="T2:U14">2.0 / 3.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">% sgp4fix divisor for divide by zero check on inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="comment">% the old check used 1.0 + cos(pi-1.0e-9), but then compared it to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="comment">% 1.5 e-12, so the threshold was changed to 1.5e-12 for consistancy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo" id="T2:U15"><span class="var type1" id="S7T2U30">temp4</span>    =   <span class="mxinfo" id="T2:U17">1.5e-12</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="comment">%  sgp4fix identify constants and allow alternate values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"><span class="keyword">global</span> <span class="var type1" id="S8T1U33">satrec</span> <span class="var type1" id="S9T4U34">gravc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T2:U20"><span class="var type1" id="S10T2U37">vkmpersec</span>     = <span class="mxinfo" id="T2:U22"><span class="mxinfo" id="T2:U23"><span class="mxinfo" id="T2:U24"><span class="var type1" id="S9T4U41">gravc</span>.radiusearthkm</span> * <span class="mxinfo" id="T2:U26"><span class="var type1" id="S9T4U44">gravc</span>.xke</span></span>/<span class="mxinfo" id="T2:U28">60.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="comment">% Clear sgp4 error flag</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo" id="T2:U29"><span class="mxinfo" id="T2:U30"><span class="var type1" id="S8T1U50">satrec</span>.t</span>     = <span class="var type1" id="S3T2U52">tsince</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo" id="T2:U33"><span class="mxinfo" id="T2:U34"><span class="var type1" id="S8T1U56">satrec</span>.error</span> = <span class="mxinfo" id="T2:U36">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo" id="T2:U37"><span class="var type1" id="S11T2U61">mrt</span> = <span class="mxinfo" id="T2:U39">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="comment">% Update for secular gravity and atmospheric drag</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="mxinfo" id="T2:U40"><span class="var type1" id="S12T2U65">xmdf</span>    = <span class="mxinfo" id="T2:U42"><span class="mxinfo" id="T2:U43"><span class="var type1" id="S8T1U68">satrec</span>.mo</span> + <span class="mxinfo" id="T2:U45"><span class="mxinfo" id="T2:U46"><span class="var type1" id="S8T1U72">satrec</span>.mdot</span> * <span class="mxinfo" id="T2:U48"><span class="var type1" id="S8T1U75">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="mxinfo" id="T2:U50"><span class="var type1" id="S13T2U79">argpdf</span>  = <span class="mxinfo" id="T2:U52"><span class="mxinfo" id="T2:U53"><span class="var type1" id="S8T1U82">satrec</span>.argpo</span> + <span class="mxinfo" id="T2:U55"><span class="mxinfo" id="T2:U56"><span class="var type1" id="S8T1U86">satrec</span>.argpdot</span> * <span class="mxinfo" id="T2:U58"><span class="var type1" id="S8T1U89">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T2:U60"><span class="var type1" id="S14T2U93">nodedf</span>  = <span class="mxinfo" id="T2:U62"><span class="mxinfo" id="T2:U63"><span class="var type1" id="S8T1U96">satrec</span>.nodeo</span> + <span class="mxinfo" id="T2:U65"><span class="mxinfo" id="T2:U66"><span class="var type1" id="S8T1U100">satrec</span>.nodedot</span> * <span class="mxinfo" id="T2:U68"><span class="var type1" id="S8T1U103">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="mxinfo" id="T2:U70"><span class="var type1" id="S15T2U107">argpm</span>   = <span class="var type1" id="S13T2U108">argpdf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo" id="T2:U73"><span class="var type1" id="S16T2U111">mm</span>      = <span class="var type1" id="S12T2U112">xmdf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T2:U76"><span class="var type1" id="S17T2U115">t2</span>      = <span class="mxinfo" id="T2:U78"><span class="mxinfo" id="T2:U79"><span class="var type1" id="S8T1U118">satrec</span>.t</span> * <span class="mxinfo" id="T2:U81"><span class="var type1" id="S8T1U121">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="mxinfo" id="T2:U83"><span class="var type1" id="S18T2U125">nodem</span>   = <span class="mxinfo" id="T2:U85"><span class="var type1" id="S14T2U127">nodedf</span> + <span class="mxinfo" id="T2:U87"><span class="mxinfo" id="T2:U88"><span class="var type1" id="S8T1U130">satrec</span>.nodecf</span> * <span class="var type1" id="S17T2U132">t2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T2:U91"><span class="var type1" id="S19T2U135">tempa</span>   = <span class="mxinfo" id="T2:U93"><span class="mxinfo" id="T2:U94">1.0</span> - <span class="mxinfo" id="T2:U95"><span class="mxinfo" id="T2:U96"><span class="var type1" id="S8T1U140">satrec</span>.cc1</span> * <span class="mxinfo" id="T2:U98"><span class="var type1" id="S8T1U143">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T2:U100"><span class="var type1" id="S20T2U147">tempe</span>   = <span class="mxinfo" id="T2:U102"><span class="mxinfo" id="T2:U103"><span class="mxinfo" id="T2:U104"><span class="var type1" id="S8T1U151">satrec</span>.bstar</span> * <span class="mxinfo" id="T2:U106"><span class="var type1" id="S8T1U154">satrec</span>.cc4</span></span> * <span class="mxinfo" id="T2:U108"><span class="var type1" id="S8T1U157">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="mxinfo" id="T2:U110"><span class="var type1" id="S21T2U161">templ</span>   = <span class="mxinfo" id="T2:U112"><span class="mxinfo" id="T2:U113"><span class="var type1" id="S8T1U164">satrec</span>.t2cof</span> * <span class="var type1" id="S17T2U166">t2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U116"><span class="mxinfo" id="T2:U117"><span class="var type1" id="S8T1U172">satrec</span>.isimp</span> ~= <span class="mxinfo" id="T2:U119">1</span></span>) <span class="comment">% Not deep space model</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo" id="T2:U120"><span class="var type1" id="S22T2U177">delomg</span> = <span class="mxinfo" id="T2:U122"><span class="mxinfo" id="T2:U123"><span class="var type1" id="S8T1U180">satrec</span>.omgcof</span> * <span class="mxinfo" id="T2:U125"><span class="var type1" id="S8T1U183">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo" id="T2:U127"><span class="var type1" id="S23T2U187">delm</span>   = <span class="mxinfo" id="T2:U129"><span class="mxinfo" id="T2:U130"><span class="var type1" id="S8T1U190">satrec</span>.xmcof</span> *<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"><span class="mxinfo" id="T2:U127"><span class="mxinfo" id="T2:U129">        (<span class="mxinfo" id="T2:U132"><span class="mxinfo" id="T2:U133">(<span class="mxinfo" id="T2:U134"><span class="mxinfo" id="T2:U135">1.0</span> + <span class="mxinfo" id="T2:U136"><span class="mxinfo" id="T2:U137"><span class="var type1" id="S8T1U200">satrec</span>.eta</span> * <span class="mxinfo" id="T2:U139">cos(<span class="var type1" id="S12T2U204">xmdf</span>)</span></span></span>)^3</span> -<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"><span class="mxinfo" id="T2:U127"><span class="mxinfo" id="T2:U129"><span class="mxinfo" id="T2:U132">        <span class="mxinfo" id="T2:U141"><span class="var type1" id="S8T1U207">satrec</span>.delmo</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    <span class="mxinfo" id="T2:U143"><span class="var type1" id="S25T2U211">temp</span>   = <span class="mxinfo" id="T2:U145"><span class="var type1" id="S22T2U213">delomg</span> + <span class="var type1" id="S23T2U214">delm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo" id="T2:U148"><span class="var type1" id="S16T2U217">mm</span>     = <span class="mxinfo" id="T2:U150"><span class="var type1" id="S12T2U219">xmdf</span> + <span class="var type1" id="S25T2U220">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="mxinfo" id="T2:U153"><span class="var type1" id="S15T2U223">argpm</span>  = <span class="mxinfo" id="T2:U155"><span class="var type1" id="S13T2U225">argpdf</span> - <span class="var type1" id="S25T2U226">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo" id="T2:U158"><span class="var type1" id="S26T2U229">t3</span>     = <span class="mxinfo" id="T2:U160"><span class="var type1" id="S17T2U231">t2</span> * <span class="mxinfo" id="T2:U162"><span class="var type1" id="S8T1U233">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo" id="T2:U164"><span class="var type1" id="S27T2U237">t4</span>     = <span class="mxinfo" id="T2:U166"><span class="var type1" id="S26T2U239">t3</span> * <span class="mxinfo" id="T2:U168"><span class="var type1" id="S8T1U241">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo" id="T2:U170"><span class="var type1" id="S19T2U245">tempa</span>  = <span class="mxinfo" id="T2:U172"><span class="mxinfo" id="T2:U173"><span class="mxinfo" id="T2:U174"><span class="var type1" id="S19T2U249">tempa</span> - <span class="mxinfo" id="T2:U176"><span class="mxinfo" id="T2:U177"><span class="var type1" id="S8T1U252">satrec</span>.d2</span> * <span class="var type1" id="S17T2U254">t2</span></span></span> - <span class="mxinfo" id="T2:U180"><span class="mxinfo" id="T2:U181"><span class="var type1" id="S8T1U257">satrec</span>.d3</span> * <span class="var type1" id="S26T2U259">t3</span></span></span> -<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="mxinfo" id="T2:U170"><span class="mxinfo" id="T2:U172">        <span class="mxinfo" id="T2:U184"><span class="mxinfo" id="T2:U185"><span class="var type1" id="S8T1U262">satrec</span>.d4</span> * <span class="var type1" id="S27T2U264">t4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo" id="T2:U188"><span class="var type1" id="S20T2U267">tempe</span>  = <span class="mxinfo" id="T2:U190"><span class="var type1" id="S20T2U269">tempe</span> + <span class="mxinfo" id="T2:U192"><span class="mxinfo" id="T2:U193"><span class="mxinfo" id="T2:U194"><span class="var type1" id="S8T1U273">satrec</span>.bstar</span> * <span class="mxinfo" id="T2:U196"><span class="var type1" id="S8T1U276">satrec</span>.cc5</span></span> * (<span class="mxinfo" id="T2:U198"><span class="mxinfo" id="T2:U199">sin(<span class="var type1" id="S16T2U282">mm</span>)</span> -<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"><span class="mxinfo" id="T2:U188"><span class="mxinfo" id="T2:U190"><span class="mxinfo" id="T2:U192"><span class="mxinfo" id="T2:U198">        <span class="mxinfo" id="T2:U201"><span class="var type1" id="S8T1U284">satrec</span>.sinmao</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo" id="T2:U203"><span class="var type1" id="S21T2U288">templ</span>  = <span class="mxinfo" id="T2:U205"><span class="mxinfo" id="T2:U206"><span class="var type1" id="S21T2U291">templ</span> + <span class="mxinfo" id="T2:U208"><span class="mxinfo" id="T2:U209"><span class="var type1" id="S8T1U294">satrec</span>.t3cof</span> * <span class="var type1" id="S26T2U296">t3</span></span></span> + <span class="mxinfo" id="T2:U212"><span class="var type1" id="S27T2U298">t4</span> * (<span class="mxinfo" id="T2:U214"><span class="mxinfo" id="T2:U215"><span class="var type1" id="S8T1U302">satrec</span>.t4cof</span> +<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo" id="T2:U203"><span class="mxinfo" id="T2:U205"><span class="mxinfo" id="T2:U212"><span class="mxinfo" id="T2:U214">        <span class="mxinfo" id="T2:U217"><span class="mxinfo" id="T2:U218"><span class="var type1" id="S8T1U306">satrec</span>.t</span> * <span class="mxinfo" id="T2:U220"><span class="var type1" id="S8T1U309">satrec</span>.t5cof</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"><span class="mxinfo" id="T2:U222"><span class="var type1" id="S29T2U313">nm</span>    = <span class="mxinfo" id="T2:U224"><span class="var type1" id="S8T1U315">satrec</span>.no</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="mxinfo" id="T2:U226"><span class="var type1" id="S30T2U319">em</span>    = <span class="mxinfo" id="T2:U228"><span class="var type1" id="S8T1U321">satrec</span>.ecco</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="mxinfo" id="T2:U230"><span class="var type1" id="S31T2U325">inclm</span> = <span class="mxinfo" id="T2:U232"><span class="var type1" id="S8T1U327">satrec</span>.inclo</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U234"><span class="var type1" id="S29T2U333">nm</span> &lt;= <span class="mxinfo" id="T2:U236">0.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo" id="T2:U237"><span class="mxinfo" id="T2:U238"><span class="var type1" id="S8T1U338">satrec</span>.error</span> = <span class="mxinfo" id="T2:U240">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T2:U241"><span class="var type1" id="S32T2U343">am</span> = <span class="mxinfo" id="T2:U243"><span class="mxinfo" id="T2:U244"><span class="mxinfo" id="T2:U245">(<span class="mxinfo" id="T2:U246"><span class="mxinfo" id="T2:U247"><span class="var type1" id="S9T4U350">gravc</span>.xke</span> / <span class="var type1" id="S29T2U352">nm</span></span>)^<span class="var type1" id="S6T2U353">x2o3</span></span> * <span class="var type1" id="S19T2U354">tempa</span></span> * <span class="var type1" id="S19T2U355">tempa</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo" id="T2:U253"><span class="var type1" id="S29T2U358">nm</span> = <span class="mxinfo" id="T2:U255"><span class="mxinfo" id="T2:U256"><span class="var type1" id="S9T4U361">gravc</span>.xke</span> / <span class="mxinfo" id="T2:U258"><span class="var type1" id="S32T2U364">am</span>^1.5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T2:U260"><span class="var type1" id="S30T2U368">em</span> = <span class="mxinfo" id="T2:U262"><span class="var type1" id="S30T2U370">em</span> - <span class="var type1" id="S20T2U371">tempe</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="comment">% fix tolerance for error recognition</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="keyword">if</span> ((<span class="mxinfo" id="T5:U265"><span class="var type1" id="S30T2U379">em</span> &gt;= <span class="mxinfo" id="T2:U267">1.0</span></span>) || (<span class="mxinfo" id="T5:U268"><span class="var type1" id="S30T2U383">em</span> &lt; <span class="mxinfo" id="T2:U270">-<span class="mxinfo" id="T2:U271">0.001</span></span></span>) || (<span class="mxinfo" id="T5:U272"><span class="var type1" id="S32T2U388">am</span> &lt; <span class="mxinfo" id="T2:U274">0.95</span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">    <span class="mxinfo" id="T2:U275"><span class="mxinfo" id="T2:U276"><span class="var type1" id="S8T1U393">satrec</span>.error</span> = <span class="mxinfo" id="T2:U278">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="comment">%   sgp4fix change test condition for eccentricity</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U279"><span class="var type1" id="S30T2U400">em</span> &lt; <span class="mxinfo" id="T2:U281">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    <span class="mxinfo" id="T2:U282"><span class="var type1" id="S30T2U404">em</span>  = <span class="mxinfo" id="T2:U284">1.0e-6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo" id="T2:U285"><span class="var type1" id="S16T2U408">mm</span>     = <span class="mxinfo" id="T2:U287"><span class="var type1" id="S16T2U410">mm</span> + <span class="mxinfo" id="T2:U289"><span class="mxinfo" id="T2:U290"><span class="var type1" id="S8T1U413">satrec</span>.no</span> * <span class="var type1" id="S21T2U415">templ</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo" id="T2:U293"><span class="var type1" id="S33T2U418">xlm</span>    = <span class="mxinfo" id="T2:U295"><span class="mxinfo" id="T2:U296"><span class="var type1" id="S16T2U421">mm</span> + <span class="var type1" id="S15T2U422">argpm</span></span> + <span class="var type1" id="S18T2U423">nodem</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo" id="T2:U300"><span class="var type1" id="S34T2U426">emsq</span>   = <span class="mxinfo" id="T2:U302"><span class="var type1" id="S30T2U428">em</span> * <span class="var type1" id="S30T2U429">em</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo" id="T2:U305"><span class="var type1" id="S25T2U432">temp</span>   = <span class="mxinfo" id="T2:U307"><span class="mxinfo" id="T2:U308">1.0</span> - <span class="var type1" id="S34T2U435">emsq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T2:U310"><span class="var type1" id="S18T2U438">nodem</span>  = <span class="mxinfo" id="T2:U312">rem(<span class="var type1" id="S18T2U441">nodem</span>, <span class="mxinfo" id="T2:U314"><span class="var type1" id="S4T2U442">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T2:U316"><span class="var type1" id="S15T2U445">argpm</span>  = <span class="mxinfo" id="T2:U318">rem(<span class="var type1" id="S15T2U448">argpm</span>, <span class="mxinfo" id="T2:U320"><span class="var type1" id="S4T2U449">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="mxinfo" id="T2:U322"><span class="var type1" id="S33T2U452">xlm</span>    = <span class="mxinfo" id="T2:U324">rem(<span class="var type1" id="S33T2U455">xlm</span>, <span class="mxinfo" id="T2:U326"><span class="var type1" id="S4T2U456">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo" id="T2:U328"><span class="var type1" id="S16T2U459">mm</span>     = <span class="mxinfo" id="T2:U330">rem(<span class="mxinfo" id="T2:U331"><span class="mxinfo" id="T2:U332"><span class="var type1" id="S33T2U464">xlm</span> - <span class="var type1" id="S15T2U465">argpm</span></span> - <span class="var type1" id="S18T2U466">nodem</span></span>, <span class="mxinfo" id="T2:U336"><span class="var type1" id="S4T2U467">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="comment">% compute extra mean quantities</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="mxinfo" id="T2:U338"><span class="var type1" id="S36T2U470">sinim</span> = <span class="mxinfo" id="T2:U340">sin(<span class="var type1" id="S31T2U473">inclm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="mxinfo" id="T2:U342"><span class="var type1" id="S37T2U476">cosim</span> = <span class="mxinfo" id="T2:U344">cos(<span class="var type1" id="S31T2U479">inclm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="comment">% add lunar-solar periodics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo" id="T2:U346"><span class="var type1" id="S38T2U482">ep</span>     = <span class="var type1" id="S30T2U483">em</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="mxinfo" id="T2:U349"><span class="var type1" id="S39T2U486">xincp</span>  = <span class="var type1" id="S31T2U487">inclm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo" id="T2:U352"><span class="var type1" id="S40T2U490">argpp</span>  = <span class="var type1" id="S15T2U491">argpm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="mxinfo" id="T2:U355"><span class="var type1" id="S41T2U494">nodep</span>  = <span class="var type1" id="S18T2U495">nodem</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo" id="T2:U358"><span class="var type1" id="S42T2U498">mp</span>     = <span class="var type1" id="S16T2U499">mm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T2:U361"><span class="var type1" id="S43T2U502">sinip</span>  = <span class="var type1" id="S36T2U503">sinim</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo" id="T2:U364"><span class="var type1" id="S44T2U506">cosip</span>  = <span class="var type1" id="S37T2U507">cosim</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"><span class="comment">% long period periodics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo" id="T2:U367"><span class="var type1" id="S45T2U510">axnl</span> = <span class="mxinfo" id="T2:U369"><span class="var type1" id="S38T2U512">ep</span> * <span class="mxinfo" id="T2:U371">cos(<span class="var type1" id="S40T2U515">argpp</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"><span class="mxinfo" id="T2:U373"><span class="var type1" id="S25T2U518">temp</span> = <span class="mxinfo" id="T2:U375"><span class="mxinfo" id="T2:U376">1.0</span> / (<span class="mxinfo" id="T2:U377"><span class="var type1" id="S32T2U523">am</span> * (<span class="mxinfo" id="T2:U379"><span class="mxinfo" id="T2:U380">1.0</span> - <span class="mxinfo" id="T2:U381"><span class="var type1" id="S38T2U528">ep</span> * <span class="var type1" id="S38T2U529">ep</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"><span class="mxinfo" id="T2:U384"><span class="var type1" id="S46T2U532">aynl</span> = <span class="mxinfo" id="T2:U386"><span class="mxinfo" id="T2:U387"><span class="var type1" id="S38T2U535">ep</span>* <span class="mxinfo" id="T2:U389">sin(<span class="var type1" id="S40T2U538">argpp</span>)</span></span> + <span class="mxinfo" id="T2:U391"><span class="var type1" id="S25T2U540">temp</span> * <span class="mxinfo" id="T2:U393"><span class="var type1" id="S8T1U542">satrec</span>.aycof</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"><span class="mxinfo" id="T2:U395"><span class="var type1" id="S47T2U546">xl</span>   = <span class="mxinfo" id="T2:U397"><span class="mxinfo" id="T2:U398"><span class="mxinfo" id="T2:U399"><span class="var type1" id="S42T2U550">mp</span> + <span class="var type1" id="S40T2U551">argpp</span></span> + <span class="var type1" id="S41T2U552">nodep</span></span> + <span class="mxinfo" id="T2:U403"><span class="mxinfo" id="T2:U404"><span class="var type1" id="S25T2U555">temp</span> * <span class="mxinfo" id="T2:U406"><span class="var type1" id="S8T1U557">satrec</span>.xlcof</span></span> * <span class="var type1" id="S45T2U559">axnl</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line"><span class="comment">% solve kepler's equation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line"><span class="mxinfo" id="T2:U409"><span class="var type1" id="S48T2U562">u</span>    = <span class="mxinfo" id="T2:U411">rem(<span class="mxinfo" id="T2:U412"><span class="var type1" id="S47T2U566">xl</span> - <span class="var type1" id="S41T2U567">nodep</span></span>, <span class="mxinfo" id="T2:U415"><span class="var type1" id="S4T2U568">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line"><span class="mxinfo" id="T2:U417"><span class="var type1" id="S49T2U571">eo1</span>  = <span class="var type1" id="S48T2U572">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line"><span class="mxinfo" id="T2:U420"><span class="var type1" id="S50T2U575">tem5</span> = <span class="mxinfo" id="T2:U422">9999.9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line"><span class="mxinfo" id="T2:U423"><span class="var type1" id="S51T2U579">ktr</span> = <span class="mxinfo" id="T2:U425">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line"><span class="comment">% sgp4fix for kepler iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line"><span class="comment">% the following iteration needs better limits on corrections</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line"><span class="comment">% To please the compiler, the following variable are defined here so that</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line"><span class="comment">% they are not undefined for some execution paths.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line"><span class="mxinfo" id="T2:U426"><span class="var type1" id="S52T2U583">sineo1</span> = <span class="mxinfo" id="T2:U428">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line"><span class="mxinfo" id="T2:U429"><span class="var type1" id="S53T2U587">coseo1</span> = <span class="mxinfo" id="T2:U431">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"><span class="keyword">while</span> (( <span class="mxinfo" id="T5:U432"><span class="mxinfo" id="T2:U433">abs(<span class="var type1" id="S50T2U596">tem5</span>)</span> &gt;= <span class="mxinfo" id="T2:U435">1.0e-12</span></span>) &amp;&amp; (<span class="mxinfo" id="T5:U436"><span class="var type1" id="S51T2U600">ktr</span> &lt;= <span class="mxinfo" id="T2:U438">10</span></span>) )</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">    <span class="mxinfo" id="T2:U439"><span class="var type1" id="S52T2U604">sineo1</span> = <span class="mxinfo" id="T2:U441">sin(<span class="var type1" id="S49T2U607">eo1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">    <span class="mxinfo" id="T2:U443"><span class="var type1" id="S53T2U610">coseo1</span> = <span class="mxinfo" id="T2:U445">cos(<span class="var type1" id="S49T2U613">eo1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">    <span class="mxinfo" id="T2:U447"><span class="var type1" id="S50T2U616">tem5</span>   = <span class="mxinfo" id="T2:U449"><span class="mxinfo" id="T2:U450"><span class="mxinfo" id="T2:U451">1.0</span> - <span class="mxinfo" id="T2:U452"><span class="var type1" id="S53T2U621">coseo1</span> * <span class="var type1" id="S45T2U622">axnl</span></span></span> - <span class="mxinfo" id="T2:U455"><span class="var type1" id="S52T2U624">sineo1</span> * <span class="var type1" id="S46T2U625">aynl</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">    <span class="mxinfo" id="T2:U458"><span class="var type1" id="S50T2U628">tem5</span>   = <span class="mxinfo" id="T2:U460">(<span class="mxinfo" id="T2:U461"><span class="mxinfo" id="T2:U462"><span class="mxinfo" id="T2:U463"><span class="var type1" id="S48T2U634">u</span> - <span class="mxinfo" id="T2:U465"><span class="var type1" id="S46T2U636">aynl</span> * <span class="var type1" id="S53T2U637">coseo1</span></span></span> + <span class="mxinfo" id="T2:U468"><span class="var type1" id="S45T2U639">axnl</span> * <span class="var type1" id="S52T2U640">sineo1</span></span></span> - <span class="var type1" id="S49T2U641">eo1</span></span>) / <span class="var type1" id="S50T2U642">tem5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo" id="T5:U473"><span class="mxinfo" id="T2:U474">abs(<span class="var type1" id="S50T2U649">tem5</span>)</span> &gt;= <span class="mxinfo" id="T2:U476">0.95</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T5:U477"><span class="var type1" id="S50T2U654">tem5</span> &gt; <span class="mxinfo" id="T2:U479">0.0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">            <span class="mxinfo" id="T2:U480"><span class="var type1" id="S50T2U658">tem5</span> = <span class="mxinfo" id="T2:U482">0.95</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">            <span class="mxinfo" id="T2:U483"><span class="var type1" id="S50T2U663">tem5</span> = <span class="mxinfo" id="T2:U485">-<span class="mxinfo" id="T2:U486">0.95</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    <span class="mxinfo" id="T2:U487"><span class="var type1" id="S49T2U668">eo1</span>    = <span class="mxinfo" id="T2:U489"><span class="var type1" id="S49T2U670">eo1</span> + <span class="var type1" id="S50T2U671">tem5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    <span class="mxinfo" id="T2:U492"><span class="var type1" id="S51T2U674">ktr</span> = <span class="mxinfo" id="T2:U494"><span class="var type1" id="S51T2U676">ktr</span> + <span class="mxinfo" id="T2:U496">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line"><span class="comment">% Short period preliminary quantities</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line"><span class="mxinfo" id="T2:U497"><span class="var type1" id="S55T2U680">ecose</span> = <span class="mxinfo" id="T2:U499"><span class="mxinfo" id="T2:U500"><span class="var type1" id="S45T2U683">axnl</span>*<span class="var type1" id="S53T2U684">coseo1</span></span> + <span class="mxinfo" id="T2:U503"><span class="var type1" id="S46T2U686">aynl</span>*<span class="var type1" id="S52T2U687">sineo1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line"><span class="mxinfo" id="T2:U506"><span class="var type1" id="S56T2U690">esine</span> = <span class="mxinfo" id="T2:U508"><span class="mxinfo" id="T2:U509"><span class="var type1" id="S45T2U693">axnl</span>*<span class="var type1" id="S52T2U694">sineo1</span></span> - <span class="mxinfo" id="T2:U512"><span class="var type1" id="S46T2U696">aynl</span>*<span class="var type1" id="S53T2U697">coseo1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line"><span class="mxinfo" id="T2:U515"><span class="var type1" id="S57T2U700">el2</span>   = <span class="mxinfo" id="T2:U517"><span class="mxinfo" id="T2:U518"><span class="var type1" id="S45T2U703">axnl</span>*<span class="var type1" id="S45T2U704">axnl</span></span> + <span class="mxinfo" id="T2:U521"><span class="var type1" id="S46T2U706">aynl</span>*<span class="var type1" id="S46T2U707">aynl</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line"><span class="mxinfo" id="T2:U524"><span class="var type1" id="S58T2U710">pl</span>    = <span class="mxinfo" id="T2:U526"><span class="var type1" id="S32T2U712">am</span>*(<span class="mxinfo" id="T2:U528"><span class="mxinfo" id="T2:U529">1.0</span>-<span class="var type1" id="S57T2U716">el2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U531"><span class="var type1" id="S58T2U721">pl</span> &lt; <span class="mxinfo" id="T2:U533">0.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">    <span class="mxinfo" id="T2:U534"><span class="mxinfo" id="T2:U535"><span class="var type1" id="S8T1U726">satrec</span>.error</span> = <span class="mxinfo" id="T2:U537">4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">    <span class="mxinfo" id="T18:U538"><span class="var type1" id="S2T18U731">r</span> = <span class="mxinfo" id="T17:U540">[<span class="mxinfo" id="T2:U541">0</span>; <span class="mxinfo" id="T2:U542">0</span>; <span class="mxinfo" id="T2:U543">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">    <span class="mxinfo" id="T2:U544"><span class="var type1" id="S59T2U742">rl</span>     = <span class="mxinfo" id="T2:U546"><span class="var type1" id="S32T2U744">am</span> * (<span class="mxinfo" id="T2:U548"><span class="mxinfo" id="T2:U549">1.0</span> - <span class="var type1" id="S55T2U748">ecose</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line">    <span class="mxinfo" id="T2:U551"><span class="var type1" id="S60T2U751">rdotl</span>  = <span class="mxinfo" id="T2:U553"><span class="mxinfo" id="T2:U554"><span class="mxinfo" id="T2:U555">sqrt(<span class="var type1" id="S32T2U756">am</span>)</span> * <span class="var type1" id="S56T2U757">esine</span></span>/<span class="var type1" id="S59T2U758">rl</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line">    <span class="mxinfo" id="T2:U559"><span class="var type1" id="S62T2U761">rvdotl</span> = <span class="mxinfo" id="T2:U561"><span class="mxinfo" id="T2:U562">sqrt(<span class="var type1" id="S58T2U765">pl</span>)</span> / <span class="var type1" id="S59T2U766">rl</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line">    <span class="mxinfo" id="T2:U565"><span class="var type1" id="S63T2U769">betal</span>  = <span class="mxinfo" id="T2:U567">sqrt(<span class="mxinfo" id="T2:U568"><span class="mxinfo" id="T2:U569">1.0</span> - <span class="var type1" id="S57T2U774">el2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">    <span class="mxinfo" id="T2:U571"><span class="var type1" id="S25T2U777">temp</span>   = <span class="mxinfo" id="T2:U573"><span class="var type1" id="S56T2U779">esine</span> / (<span class="mxinfo" id="T2:U575"><span class="mxinfo" id="T2:U576">1.0</span> + <span class="var type1" id="S63T2U783">betal</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line">    <span class="mxinfo" id="T2:U578"><span class="var type1" id="S64T2U786">sinu</span>   = <span class="mxinfo" id="T2:U580"><span class="mxinfo" id="T2:U581"><span class="var type1" id="S32T2U789">am</span> / <span class="var type1" id="S59T2U790">rl</span></span> * (<span class="mxinfo" id="T2:U584"><span class="mxinfo" id="T2:U585"><span class="var type1" id="S52T2U794">sineo1</span> - <span class="var type1" id="S46T2U795">aynl</span></span> - <span class="mxinfo" id="T2:U588"><span class="var type1" id="S45T2U797">axnl</span> * <span class="var type1" id="S25T2U798">temp</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line">    <span class="mxinfo" id="T2:U591"><span class="var type1" id="S65T2U801">cosu</span>   = <span class="mxinfo" id="T2:U593"><span class="mxinfo" id="T2:U594"><span class="var type1" id="S32T2U804">am</span> / <span class="var type1" id="S59T2U805">rl</span></span> * (<span class="mxinfo" id="T2:U597"><span class="mxinfo" id="T2:U598"><span class="var type1" id="S53T2U809">coseo1</span> - <span class="var type1" id="S45T2U810">axnl</span></span> + <span class="mxinfo" id="T2:U601"><span class="var type1" id="S46T2U812">aynl</span> * <span class="var type1" id="S25T2U813">temp</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">    <span class="mxinfo" id="T2:U604"><span class="var type1" id="S66T2U816">su</span>     = <span class="mxinfo" id="T2:U606">atan2(<span class="var type1" id="S64T2U819">sinu</span>, <span class="var type1" id="S65T2U820">cosu</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line">    <span class="mxinfo" id="T2:U609"><span class="var type1" id="S68T2U823">sin2u</span>  = <span class="mxinfo" id="T2:U611">(<span class="mxinfo" id="T2:U612"><span class="var type1" id="S65T2U827">cosu</span> + <span class="var type1" id="S65T2U828">cosu</span></span>) * <span class="var type1" id="S64T2U829">sinu</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">    <span class="mxinfo" id="T2:U616"><span class="var type1" id="S69T2U832">cos2u</span>  = <span class="mxinfo" id="T2:U618"><span class="mxinfo" id="T2:U619">1.0</span> - <span class="mxinfo" id="T2:U620"><span class="mxinfo" id="T2:U621"><span class="mxinfo" id="T2:U622">2.0</span> * <span class="var type1" id="S64T2U838">sinu</span></span> * <span class="var type1" id="S64T2U839">sinu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">    <span class="mxinfo" id="T2:U625"><span class="var type1" id="S25T2U842">temp</span>   = <span class="mxinfo" id="T2:U627"><span class="mxinfo" id="T2:U628">1.0</span> / <span class="var type1" id="S58T2U845">pl</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">    <span class="mxinfo" id="T2:U630"><span class="var type1" id="S70T2U848">temp1</span>  = <span class="mxinfo" id="T2:U632"><span class="mxinfo" id="T2:U633"><span class="mxinfo" id="T2:U634">0.5</span> * <span class="mxinfo" id="T2:U635"><span class="var type1" id="S9T4U853">gravc</span>.j2</span></span> * <span class="var type1" id="S25T2U855">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">    <span class="mxinfo" id="T2:U638"><span class="var type1" id="S71T2U858">temp2</span>  = <span class="mxinfo" id="T2:U640"><span class="var type1" id="S70T2U860">temp1</span> * <span class="var type1" id="S25T2U861">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line">    <span class="comment">% update for short period periodics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">    <span class="mxinfo" id="T2:U643"><span class="var type1" id="S11T2U864">mrt</span>   = <span class="mxinfo" id="T2:U645"><span class="mxinfo" id="T2:U646"><span class="var type1" id="S59T2U867">rl</span> * (<span class="mxinfo" id="T2:U648"><span class="mxinfo" id="T2:U649">1.0</span> - <span class="mxinfo" id="T2:U650"><span class="mxinfo" id="T2:U651"><span class="mxinfo" id="T2:U652"><span class="mxinfo" id="T2:U653">1.5</span> * <span class="var type1" id="S71T2U875">temp2</span></span> * <span class="var type1" id="S63T2U876">betal</span></span> * <span class="mxinfo" id="T2:U656"><span class="var type1" id="S8T1U878">satrec</span>.con41</span></span></span>)</span> +<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line"><span class="mxinfo" id="T2:U643"><span class="mxinfo" id="T2:U645">        <span class="mxinfo" id="T2:U658"><span class="mxinfo" id="T2:U659"><span class="mxinfo" id="T2:U660"><span class="mxinfo" id="T2:U661">0.5</span> * <span class="var type1" id="S70T2U884">temp1</span></span> * <span class="mxinfo" id="T2:U663"><span class="var type1" id="S8T1U886">satrec</span>.x1mth2</span></span> * <span class="var type1" id="S69T2U888">cos2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">    <span class="mxinfo" id="T2:U666"><span class="var type1" id="S66T2U891">su</span>    = <span class="mxinfo" id="T2:U668"><span class="var type1" id="S66T2U893">su</span> - <span class="mxinfo" id="T2:U670"><span class="mxinfo" id="T2:U671"><span class="mxinfo" id="T2:U672"><span class="mxinfo" id="T2:U673">0.25</span> * <span class="var type1" id="S71T2U898">temp2</span></span> * <span class="mxinfo" id="T2:U675"><span class="var type1" id="S8T1U900">satrec</span>.x7thm1</span></span> * <span class="var type1" id="S68T2U902">sin2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">    <span class="mxinfo" id="T2:U678"><span class="var type1" id="S72T2U905">xnode</span> = <span class="mxinfo" id="T2:U680"><span class="var type1" id="S41T2U907">nodep</span> + <span class="mxinfo" id="T2:U682"><span class="mxinfo" id="T2:U683"><span class="mxinfo" id="T2:U684"><span class="mxinfo" id="T2:U685">1.5</span> * <span class="var type1" id="S71T2U912">temp2</span></span> * <span class="var type1" id="S44T2U913">cosip</span></span> * <span class="var type1" id="S68T2U914">sin2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">    <span class="mxinfo" id="T2:U689"><span class="var type1" id="S73T2U917">xinc</span>  = <span class="mxinfo" id="T2:U691"><span class="var type1" id="S39T2U919">xincp</span> + <span class="mxinfo" id="T2:U693"><span class="mxinfo" id="T2:U694"><span class="mxinfo" id="T2:U695"><span class="mxinfo" id="T2:U696"><span class="mxinfo" id="T2:U697">1.5</span> * <span class="var type1" id="S71T2U925">temp2</span></span> * <span class="var type1" id="S44T2U926">cosip</span></span> * <span class="var type1" id="S43T2U927">sinip</span></span> * <span class="var type1" id="S69T2U928">cos2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line">    <span class="mxinfo" id="T2:U702"><span class="var type1" id="S74T2U931">mvt</span>   = <span class="mxinfo" id="T2:U704"><span class="var type1" id="S60T2U933">rdotl</span> - <span class="mxinfo" id="T2:U706"><span class="mxinfo" id="T2:U707"><span class="mxinfo" id="T2:U708"><span class="mxinfo" id="T2:U709"><span class="var type1" id="S29T2U938">nm</span> * <span class="var type1" id="S70T2U939">temp1</span></span> * <span class="mxinfo" id="T2:U712"><span class="var type1" id="S8T1U941">satrec</span>.x1mth2</span></span> * <span class="var type1" id="S68T2U943">sin2u</span></span> / <span class="mxinfo" id="T2:U715"><span class="var type1" id="S9T4U945">gravc</span>.xke</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line">    <span class="mxinfo" id="T2:U717"><span class="var type1" id="S75T2U949">rvdot</span> = <span class="mxinfo" id="T2:U719"><span class="var type1" id="S62T2U951">rvdotl</span> + <span class="mxinfo" id="T2:U721"><span class="mxinfo" id="T2:U722"><span class="mxinfo" id="T2:U723"><span class="var type1" id="S29T2U955">nm</span> * <span class="var type1" id="S70T2U956">temp1</span></span> * (<span class="mxinfo" id="T2:U726"><span class="mxinfo" id="T2:U727"><span class="mxinfo" id="T2:U728"><span class="var type1" id="S8T1U961">satrec</span>.x1mth2</span> * <span class="var type1" id="S69T2U963">cos2u</span></span> +<span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line"><span class="mxinfo" id="T2:U717"><span class="mxinfo" id="T2:U719"><span class="mxinfo" id="T2:U721"><span class="mxinfo" id="T2:U722"><span class="mxinfo" id="T2:U726">        <span class="mxinfo" id="T2:U731"><span class="mxinfo" id="T2:U732">1.5</span> * <span class="mxinfo" id="T2:U733"><span class="var type1" id="S8T1U967">satrec</span>.con41</span></span></span>)</span> / <span class="mxinfo" id="T2:U735"><span class="var type1" id="S9T4U970">gravc</span>.xke</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">    <span class="comment">% orientation vectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line">    <span class="mxinfo" id="T2:U737"><span class="var type1" id="S76T2U974">sinsu</span> =  <span class="mxinfo" id="T2:U739">sin(<span class="var type1" id="S66T2U977">su</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line">    <span class="mxinfo" id="T2:U741"><span class="var type1" id="S77T2U980">cossu</span> =  <span class="mxinfo" id="T2:U743">cos(<span class="var type1" id="S66T2U983">su</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line">    <span class="mxinfo" id="T2:U745"><span class="var type1" id="S78T2U986">snod</span>  =  <span class="mxinfo" id="T2:U747">sin(<span class="var type1" id="S72T2U989">xnode</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line">    <span class="mxinfo" id="T2:U749"><span class="var type1" id="S79T2U992">cnod</span>  =  <span class="mxinfo" id="T2:U751">cos(<span class="var type1" id="S72T2U995">xnode</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line">    <span class="mxinfo" id="T2:U753"><span class="var type1" id="S80T2U998">sini</span>  =  <span class="mxinfo" id="T2:U755">sin(<span class="var type1" id="S73T2U1001">xinc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line">    <span class="mxinfo" id="T2:U757"><span class="var type1" id="S81T2U1004">cosi</span>  =  <span class="mxinfo" id="T2:U759">cos(<span class="var type1" id="S73T2U1007">xinc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line">    <span class="mxinfo" id="T2:U761"><span class="var type1" id="S82T2U1010">xmx</span>   = <span class="mxinfo" id="T2:U763"><span class="mxinfo" id="T2:U764">-<span class="var type1" id="S78T2U1013">snod</span></span> * <span class="var type1" id="S81T2U1014">cosi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line">    <span class="mxinfo" id="T2:U767"><span class="var type1" id="S83T2U1017">xmy</span>   =  <span class="mxinfo" id="T2:U769"><span class="var type1" id="S79T2U1019">cnod</span> * <span class="var type1" id="S81T2U1020">cosi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line">    <span class="mxinfo" id="T2:U772"><span class="var type1" id="S84T2U1023">ux</span>    =  <span class="mxinfo" id="T2:U774"><span class="mxinfo" id="T2:U775"><span class="var type1" id="S82T2U1026">xmx</span> * <span class="var type1" id="S76T2U1027">sinsu</span></span> + <span class="mxinfo" id="T2:U778"><span class="var type1" id="S79T2U1029">cnod</span> * <span class="var type1" id="S77T2U1030">cossu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line">    <span class="mxinfo" id="T2:U781"><span class="var type1" id="S85T2U1033">uy</span>    =  <span class="mxinfo" id="T2:U783"><span class="mxinfo" id="T2:U784"><span class="var type1" id="S83T2U1036">xmy</span> * <span class="var type1" id="S76T2U1037">sinsu</span></span> + <span class="mxinfo" id="T2:U787"><span class="var type1" id="S78T2U1039">snod</span> * <span class="var type1" id="S77T2U1040">cossu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line">    <span class="mxinfo" id="T2:U790"><span class="var type1" id="S86T2U1043">uz</span>    =  <span class="mxinfo" id="T2:U792"><span class="var type1" id="S80T2U1045">sini</span> * <span class="var type1" id="S76T2U1046">sinsu</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line">    <span class="mxinfo" id="T2:U795"><span class="var type1" id="S87T2U1049">vx</span>    =  <span class="mxinfo" id="T2:U797"><span class="mxinfo" id="T2:U798"><span class="var type1" id="S82T2U1052">xmx</span> * <span class="var type1" id="S77T2U1053">cossu</span></span> - <span class="mxinfo" id="T2:U801"><span class="var type1" id="S79T2U1055">cnod</span> * <span class="var type1" id="S76T2U1056">sinsu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line">    <span class="mxinfo" id="T2:U804"><span class="var type1" id="S88T2U1059">vy</span>    =  <span class="mxinfo" id="T2:U806"><span class="mxinfo" id="T2:U807"><span class="var type1" id="S83T2U1062">xmy</span> * <span class="var type1" id="S77T2U1063">cossu</span></span> - <span class="mxinfo" id="T2:U810"><span class="var type1" id="S78T2U1065">snod</span> * <span class="var type1" id="S76T2U1066">sinsu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line">    <span class="mxinfo" id="T2:U813"><span class="var type1" id="S89T2U1069">vz</span>    =  <span class="mxinfo" id="T2:U815"><span class="var type1" id="S80T2U1071">sini</span> * <span class="var type1" id="S77T2U1072">cossu</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">      </span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">    <span class="comment">% position and velocity (in km and km/sec)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">    <span class="mxinfo" id="T18:U818"><span class="var type1" id="S2T18U1075">r</span> = <span class="mxinfo" id="T17:U820">zeros(<span class="mxinfo" id="T2:U821">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">    <span class="mxinfo" id="T17:U822"><span class="var type1" id="S91T17U1082">v</span> = <span class="mxinfo" id="T17:U824">zeros(<span class="mxinfo" id="T2:U825">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line">    <span class="mxinfo" id="T2:U826"><span class="mxinfo" id="T2:U827"><span class="var type1" id="S2T18U1090">r</span>(<span class="mxinfo" id="T2:U829">1</span>,<span class="mxinfo" id="T2:U830">1</span>)</span> = <span class="mxinfo" id="T2:U831">(<span class="mxinfo" id="T2:U832"><span class="var type1" id="S11T2U1096">mrt</span> * <span class="var type1" id="S84T2U1097">ux</span></span>)* <span class="mxinfo" id="T2:U835"><span class="var type1" id="S9T4U1099">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line">    <span class="mxinfo" id="T2:U837"><span class="mxinfo" id="T2:U838"><span class="var type1" id="S2T18U1104">r</span>(<span class="mxinfo" id="T2:U840">2</span>,<span class="mxinfo" id="T2:U841">1</span>)</span> = <span class="mxinfo" id="T2:U842">(<span class="mxinfo" id="T2:U843"><span class="var type1" id="S11T2U1110">mrt</span> * <span class="var type1" id="S85T2U1111">uy</span></span>)* <span class="mxinfo" id="T2:U846"><span class="var type1" id="S9T4U1113">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line">    <span class="mxinfo" id="T2:U848"><span class="mxinfo" id="T2:U849"><span class="var type1" id="S2T18U1118">r</span>(<span class="mxinfo" id="T2:U851">3</span>,<span class="mxinfo" id="T2:U852">1</span>)</span> = <span class="mxinfo" id="T2:U853">(<span class="mxinfo" id="T2:U854"><span class="var type1" id="S11T2U1124">mrt</span> * <span class="var type1" id="S86T2U1125">uz</span></span>)* <span class="mxinfo" id="T2:U857"><span class="var type1" id="S9T4U1127">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line"><span class="comment">%     v(1,1) = (mvt * ux + rvdot * vx) * vkmpersec;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line"><span class="comment">%     v(2,1) = (mvt * uy + rvdot * vy) * vkmpersec;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line"><span class="comment">%     v(3,1) = (mvt * uz + rvdot * vz) * vkmpersec;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line">    <span class="comment">% Calculate the GMST1982 angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line">    <span class="mxinfo" id="T2:U859"><span class="var type1" id="S92T2U1131">TUT1</span> = <span class="mxinfo" id="T2:U861">(<span class="mxinfo" id="T2:U862"><span class="mxinfo" id="T2:U863"><span class="mxinfo" id="T2:U864"><span class="var type1" id="S8T1U1137">satrec</span>.jdsatepoch</span> + <span class="mxinfo" id="T2:U866"><span class="var type1" id="S3T2U1140">tsince</span>/<span class="mxinfo" id="T2:U868">1440</span></span></span> - <span class="mxinfo" id="T2:U869">2451545.0</span></span>)/<span class="mxinfo" id="T2:U870">36525</span></span></span>; <span class="comment">% 1440 minutes in a day</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line">    <span class="mxinfo" id="T2:U871"><span class="var type1" id="S93T2U1146">TGMST_1982</span> = <span class="mxinfo" id="T2:U873"><span class="mxinfo" id="T2:U874"><span class="mxinfo" id="T2:U875"><span class="mxinfo" id="T2:U876">67310.54841</span> + <span class="mxinfo" id="T2:U877">(<span class="mxinfo" id="T2:U878">876600*3600 + 8640184.812866</span>)*<span class="var type1" id="S92T2U1158">TUT1</span></span></span> + <span class="mxinfo" id="T2:U880"><span class="mxinfo" id="T2:U881">0.093104</span>*<span class="mxinfo" id="T2:U882"><span class="var type1" id="S92T2U1162">TUT1</span>^2</span></span></span> - <span class="mxinfo" id="T2:U884"><span class="mxinfo" id="T2:U885">6.2E-6</span>*<span class="mxinfo" id="T2:U886"><span class="var type1" id="S92T2U1167">TUT1</span>^3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line">    <span class="mxinfo" id="T2:U888"><span class="var type1" id="S93T2U1171">TGMST_1982</span> = <span class="mxinfo" id="T2:U890"><span class="mxinfo" id="T2:U891">(<span class="mxinfo" id="T2:U892"><span class="mxinfo" id="T2:U893">mod(<span class="var type1" id="S93T2U1178">TGMST_1982</span>,<span class="mxinfo" id="T2:U895">86400</span>)</span>/<span class="mxinfo" id="T2:U896">240</span></span>)*<span class="mxinfo" id="T2:U897">pi</span></span>/<span class="mxinfo" id="T2:U898">180</span></span></span>; <span class="comment">% 1 sec = 1/240 degrees</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line">    <span class="mxinfo" id="T11:U899"><span class="var type1" id="S95T11U1186">ROT3</span> = <span class="mxinfo" id="T11:U901">[<span class="mxinfo" id="T16:U902"><span class="mxinfo" id="T2:U903">cos(<span class="var type1" id="S93T2U1191">TGMST_1982</span>)</span> <span class="mxinfo" id="T2:U905">-<span class="mxinfo" id="T2:U906">sin(<span class="var type1" id="S93T2U1195">TGMST_1982</span>)</span></span> <span class="mxinfo" id="T2:U908">0</span></span>;<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line"><span class="mxinfo" id="T11:U899"><span class="mxinfo" id="T11:U901">        <span class="mxinfo" id="T16:U909"><span class="mxinfo" id="T2:U910">sin(<span class="var type1" id="S93T2U1200">TGMST_1982</span>)</span> <span class="mxinfo" id="T2:U912">cos(<span class="var type1" id="S93T2U1203">TGMST_1982</span>)</span> <span class="mxinfo" id="T2:U914">0</span></span>;<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line"><span class="mxinfo" id="T11:U899"><span class="mxinfo" id="T11:U901">        <span class="mxinfo" id="T16:U915"><span class="mxinfo" id="T2:U916">0</span> <span class="mxinfo" id="T2:U917">0</span> <span class="mxinfo" id="T2:U918">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line">    <span class="mxinfo" id="T18:U919"><span class="var type1" id="S2T18U1211">r</span> = <span class="mxinfo" id="T18:U921"><span class="mxinfo" id="T11:U922"><span class="var type1" id="S95T11U1214">ROT3</span>'</span>*<span class="var type1" id="S2T18U1215">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line"><span class="comment">%     LLA = convert_ecef2lla(r'*1000);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line"><span class="comment">%     w_e = [0; 0; 0.00007292115855300]; % rad/solar second</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line"><span class="comment">%     v = ROT3'*v + cross(w_e,r);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line"><span class="keyword">end</span> <span class="comment">% // if pl &gt; 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line"><span class="comment">% // sgp4fix for decaying satellites</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U925"><span class="var type1" id="S11T2U1220">mrt</span> &lt; <span class="mxinfo" id="T2:U927">1.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line">    <span class="mxinfo" id="T2:U928"><span class="mxinfo" id="T2:U929"><span class="var type1" id="S8T1U1225">satrec</span>.error</span> = <span class="mxinfo" id="T2:U931">6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"><span class="comment">% global idebug dbgfile</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line"><span class="comment">% if idebug</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"><span class="comment">%     debug7;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"><span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line"><span class="comment">% function LLA = convert_ecef2lla(r)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line"><span class="comment">% Re = 6371*1000; % m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line"><span class="comment">% R = sqrt(sum(r.^2));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="comment">% xy = sqrt(r(1)^2 + r(2)^2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line"><span class="comment">% lon = -acosd(r(1)/xy);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line"><span class="comment">% lat = acosd(xy/R);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"><span class="comment">% alt = R - Re;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"><span class="comment">% LLA = [lat lon alt];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line"><span class="comment">% end</span></span></span>
</pre>
