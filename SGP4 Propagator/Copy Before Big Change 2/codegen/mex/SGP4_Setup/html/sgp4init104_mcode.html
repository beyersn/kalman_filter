<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="48,1" id="srcline1">  1</a></span><span class="line"><span class="comment">% -----------------------------------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%                              procedure sgp4init</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   this procedure initializes variables for sgp4.</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% Author:</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   Jeff Beck</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   beckja@alumni.lehigh.edu</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%   1.0 (aug 7, 2006) - update for paper dav</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% original comments from Vallado C++ version:</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   author        : david vallado                  719-573-2600   28 jun 2005</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%   inputs        :</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%     satn        - satellite number</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%     bstar       - sgp4 type drag coefficient              kg/m2er</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%     ecco        - eccentricity</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%     epoch       - epoch time in days from jan 0, 1950. 0 hr</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%     argpo       - argument of perigee (output if ds)</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%     inclo       - inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%     mo          - mean anomaly (output if ds)</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%     no          - mean motion</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%     nodeo      - right ascension of ascending node</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%   outputs       :</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%     satrec      - common values for subsequent calls</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%     return code - non-zero on error.</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%                    1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%                    2 - mean motion less than 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%                    3 - pert elements, ecc &lt; 0.0  or  ecc &gt; 1.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%                    4 - semi-latus rectum &lt; 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%                    5 - epoch elements are sub-orbital</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%                    6 - satellite has decayed</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%   locals        :</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%     CNODM  , SNODM  , COSIM  , SINIM  , COSOMM , SINOMM</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%     Cc1sq  , Cc2    , Cc3</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%     Coef   , Coef1</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%     cosio4      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%     day         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%     dndt        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%     em          - eccentricity</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%     emsq        - eccentricity squared</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%     eeta        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%     etasq       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%     gam         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%     argpm       - argument of perigee</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%     ndem        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%     inclm       - inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%     mm          - mean anomaly</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%     nm          - mean motion</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%     perige      - perigee</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%     pinvsq      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%     psisq       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%     qzms24      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%     rtemsq      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%     s1, s2, s3, s4, s5, s6, s7          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%     sfour       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%     ss1, ss2, ss3, ss4, ss5, ss6, ss7         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%     sz1, sz2, sz3</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%     sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">%     tc          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%     temp        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%     temp1, temp2, temp3       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%     tsi         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%     xpidot      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">%     xhdot1      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%     z1, z2, z3          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%     z11, z12, z13, z21, z22, z23, z31, z32, z33         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%   coupling      :</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%     getgravconst</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%     initl       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">%     dscom       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%     dpper       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%     dsinit      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">%     sgp4        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">%   references    :</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">%     hoots, roehrich, norad spacetrack report #3 1980</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">%     hoots, norad spacetrack report #6 1986</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%     hoots, schumacher and glover 2004</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">%     vallado, crawford, hujsak, kelso  2006</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">%  ----------------------------------------------------------------------------*/</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,86" id="srcline86"> 86</a></span><span class="line"><span class="keyword">function</span> sgp4init(<span class="var type1" id="S2T2U5">epoch</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%% Define Global Variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,88" id="srcline88"> 88</a></span><span class="line"><span class="keyword">global</span> <span class="var type2" id="S3T0U7">satrec</span> <span class="var type2" id="S4T0U8">gravc</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,89" id="srcline89"> 89</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">%% Initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">% Set all near earth variables to zero;</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,92" id="srcline92"> 92</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo" id="T2:U2"><span class="mxinfo" id="T2:U3"><span class="var type1" id="S3T1U12">satrec</span>.isimp</span>   = <span class="mxinfo" id="T2:U5">0</span></span>;   <span class="mxinfo" id="T3:U6"><span class="mxinfo" id="T3:U7"><span class="var type1" id="S3T1U18">satrec</span>.method</span> = <span class="mxinfo" id="T3:U9"><span class="string">'n'</span></span></span>; <span class="mxinfo" id="T2:U10"><span class="mxinfo" id="T2:U11"><span class="var type1" id="S3T1U24">satrec</span>.aycof</span>    = <span class="mxinfo" id="T2:U13">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo" id="T2:U14"><span class="mxinfo" id="T2:U15"><span class="var type1" id="S3T1U30">satrec</span>.con41</span>   = <span class="mxinfo" id="T2:U17">0.0</span></span>; <span class="mxinfo" id="T2:U18"><span class="mxinfo" id="T2:U19"><span class="var type1" id="S3T1U36">satrec</span>.cc1</span>    = <span class="mxinfo" id="T2:U21">0.0</span></span>; <span class="mxinfo" id="T2:U22"><span class="mxinfo" id="T2:U23"><span class="var type1" id="S3T1U42">satrec</span>.cc4</span>      = <span class="mxinfo" id="T2:U25">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo" id="T2:U26"><span class="mxinfo" id="T2:U27"><span class="var type1" id="S3T1U48">satrec</span>.cc5</span>     = <span class="mxinfo" id="T2:U29">0.0</span></span>; <span class="mxinfo" id="T2:U30"><span class="mxinfo" id="T2:U31"><span class="var type1" id="S3T1U54">satrec</span>.d2</span>     = <span class="mxinfo" id="T2:U33">0.0</span></span>; <span class="mxinfo" id="T2:U34"><span class="mxinfo" id="T2:U35"><span class="var type1" id="S3T1U60">satrec</span>.d3</span>       = <span class="mxinfo" id="T2:U37">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo" id="T2:U38"><span class="mxinfo" id="T2:U39"><span class="var type1" id="S3T1U66">satrec</span>.d4</span>      = <span class="mxinfo" id="T2:U41">0.0</span></span>; <span class="mxinfo" id="T2:U42"><span class="mxinfo" id="T2:U43"><span class="var type1" id="S3T1U72">satrec</span>.delmo</span>  = <span class="mxinfo" id="T2:U45">0.0</span></span>; <span class="mxinfo" id="T2:U46"><span class="mxinfo" id="T2:U47"><span class="var type1" id="S3T1U78">satrec</span>.eta</span>      = <span class="mxinfo" id="T2:U49">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo" id="T2:U50"><span class="mxinfo" id="T2:U51"><span class="var type1" id="S3T1U84">satrec</span>.argpdot</span> = <span class="mxinfo" id="T2:U53">0.0</span></span>; <span class="mxinfo" id="T2:U54"><span class="mxinfo" id="T2:U55"><span class="var type1" id="S3T1U90">satrec</span>.omgcof</span> = <span class="mxinfo" id="T2:U57">0.0</span></span>; <span class="mxinfo" id="T2:U58"><span class="mxinfo" id="T2:U59"><span class="var type1" id="S3T1U96">satrec</span>.sinmao</span>   = <span class="mxinfo" id="T2:U61">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,98" id="srcline98"> 98</a></span><span class="line"><span class="mxinfo" id="T2:U62"><span class="mxinfo" id="T2:U63"><span class="var type1" id="S3T1U102">satrec</span>.t</span>       = <span class="mxinfo" id="T2:U65">0.0</span></span>; <span class="mxinfo" id="T2:U66"><span class="mxinfo" id="T2:U67"><span class="var type1" id="S3T1U108">satrec</span>.t2cof</span>  = <span class="mxinfo" id="T2:U69">0.0</span></span>; <span class="mxinfo" id="T2:U70"><span class="mxinfo" id="T2:U71"><span class="var type1" id="S3T1U114">satrec</span>.t3cof</span>    = <span class="mxinfo" id="T2:U73">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T2:U74"><span class="mxinfo" id="T2:U75"><span class="var type1" id="S3T1U120">satrec</span>.t4cof</span>   = <span class="mxinfo" id="T2:U77">0.0</span></span>; <span class="mxinfo" id="T2:U78"><span class="mxinfo" id="T2:U79"><span class="var type1" id="S3T1U126">satrec</span>.t5cof</span>  = <span class="mxinfo" id="T2:U81">0.0</span></span>; <span class="mxinfo" id="T2:U82"><span class="mxinfo" id="T2:U83"><span class="var type1" id="S3T1U132">satrec</span>.x1mth2</span>   = <span class="mxinfo" id="T2:U85">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T2:U86"><span class="mxinfo" id="T2:U87"><span class="var type1" id="S3T1U138">satrec</span>.x7thm1</span>  = <span class="mxinfo" id="T2:U89">0.0</span></span>; <span class="mxinfo" id="T2:U90"><span class="mxinfo" id="T2:U91"><span class="var type1" id="S3T1U144">satrec</span>.mdot</span>   = <span class="mxinfo" id="T2:U93">0.0</span></span>; <span class="mxinfo" id="T2:U94"><span class="mxinfo" id="T2:U95"><span class="var type1" id="S3T1U150">satrec</span>.nodedot</span> = <span class="mxinfo" id="T2:U97">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo" id="T2:U98"><span class="mxinfo" id="T2:U99"><span class="var type1" id="S3T1U156">satrec</span>.xlcof</span>   = <span class="mxinfo" id="T2:U101">0.0</span></span>; <span class="mxinfo" id="T2:U102"><span class="mxinfo" id="T2:U103"><span class="var type1" id="S3T1U162">satrec</span>.xmcof</span>  = <span class="mxinfo" id="T2:U105">0.0</span></span>; <span class="mxinfo" id="T2:U106"><span class="mxinfo" id="T2:U107"><span class="var type1" id="S3T1U168">satrec</span>.nodecf</span>  = <span class="mxinfo" id="T2:U109">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,102" id="srcline102">102</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,103" id="srcline103">103</a></span><span class="line"><span class="comment">% Deep space model is not necessary for 700 km orbit which has an expected</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,104" id="srcline104">104</a></span><span class="line"><span class="comment">% orbiting period of 100ish minutes. These variables were therefore</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,105" id="srcline105">105</a></span><span class="line"><span class="comment">% deleted.</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,106" id="srcline106">106</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,107" id="srcline107">107</a></span><span class="line"><span class="comment">%% WGS-72 Earth Constants</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,108" id="srcline108">108</a></span><span class="line"><span class="comment">% sgp4fix identify constants and allow alternate values</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,109" id="srcline109">109</a></span><span class="line"><span class="comment">% Options 721 72 84</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,110" id="srcline110">110</a></span><span class="line"><span class="comment">%getgravc( 72 );</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,111" id="srcline111">111</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T2:U110"><span class="var type1" id="S5T2U173">ss</span>     = <span class="mxinfo" id="T2:U112"><span class="mxinfo" id="T2:U113"><span class="mxinfo" id="T2:U114">78.0</span> / <span class="mxinfo" id="T2:U115"><span class="var type1" id="S4T4U178">gravc</span>.radiusearthkm</span></span> + <span class="mxinfo" id="T2:U117">1.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,113" id="srcline113">113</a></span><span class="line"><span class="mxinfo" id="T2:U118"><span class="var type1" id="S6T2U183">qzms2t</span> = <span class="mxinfo" id="T2:U120">(<span class="mxinfo" id="T2:U121">(<span class="mxinfo" id="T2:U122">120.0 - 78.0</span>) / <span class="mxinfo" id="T2:U123"><span class="var type1" id="S4T4U192">gravc</span>.radiusearthkm</span></span>)^4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo" id="T2:U125"><span class="var type1" id="S7T2U197">x2o3</span>   =  <span class="mxinfo" id="T2:U127">2.0 / 3.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,115" id="srcline115">115</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,116" id="srcline116">116</a></span><span class="line"><span class="comment">% sgp4fix divisor for divide by zero check on inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,117" id="srcline117">117</a></span><span class="line"><span class="comment">% the old check used 1.0 + cos(pi-1.0e-9), but then compared it to</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,118" id="srcline118">118</a></span><span class="line"><span class="comment">% 1.5 e-12, so the threshold was changed to 1.5e-12 for consistancy</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T2:U128"><span class="var type1" id="S8T2U203">temp4</span>    =   <span class="mxinfo" id="T2:U130">1.5e-12</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,120" id="srcline120">120</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,121" id="srcline121">121</a></span><span class="line"><span class="mxinfo" id="T3:U131"><span class="mxinfo" id="T3:U132"><span class="var type1" id="S3T1U208">satrec</span>.init</span> = <span class="mxinfo" id="T3:U134"><span class="string">'y'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T2:U135"><span class="mxinfo" id="T2:U136"><span class="var type1" id="S3T1U214">satrec</span>.t</span>    = <span class="mxinfo" id="T2:U138">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,123" id="srcline123">123</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo" id="T2:U139">[<span class="var type1" id="S9T2U220">ainv</span>,  <span class="var type1" id="S10T2U221">ao</span>, <span class="var type1" id="S11T2U222">con42</span>, <span class="var type1" id="S12T2U223">cosio</span>, <span class="var type1" id="S13T2U224">cosio2</span>, <span class="var type1" id="S14T2U225">einv</span>, <span class="var type1" id="S15T2U226">eccsq</span>, <span class="var type1" id="S16T2U227">omeosq</span>, <span class="var type1" id="S17T2U228">posq</span>, <span class="var type1" id="S18T2U229">rp</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T2:U139">    <span class="var type1" id="S19T2U230">rteosq</span>, <span class="var type1" id="S20T2U231">sinio</span>] = <span class="fcn" id="F55N6:B233">initl</span>(<span class="var type1" id="S2T2U234">epoch</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,126" id="srcline126">126</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T2:U153"><span class="mxinfo" id="T2:U154"><span class="var type1" id="S3T1U238">satrec</span>.error</span> = <span class="mxinfo" id="T2:U156">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,128" id="srcline128">128</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,129" id="srcline129">129</a></span><span class="line"><span class="comment">% sgp4fix remove this check as it is unnecessary</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,130" id="srcline130">130</a></span><span class="line"><span class="comment">% the mrt check in sgp4 handles decaying satellite cases even if the starting</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,131" id="srcline131">131</a></span><span class="line"><span class="comment">%if (rp &lt; 1.0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,132" id="srcline132">132</a></span><span class="line"><span class="comment">%   printf("# *** satn%d epoch elts sub-orbital ***\n", satn);</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,133" id="srcline133">133</a></span><span class="line"><span class="comment">%    satrec.error = 5;</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,134" id="srcline134">134</a></span><span class="line"><span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,135" id="srcline135">135</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,136" id="srcline136">136</a></span><span class="line"><span class="keyword">if</span> ((<span class="mxinfo" id="T5:U157"><span class="var type1" id="S16T2U247">omeosq</span> &gt;= <span class="mxinfo" id="T2:U159">0.0</span></span> ) || ( <span class="mxinfo" id="T5:U160"><span class="mxinfo" id="T2:U161"><span class="var type1" id="S3T1U252">satrec</span>.no</span> &gt;= <span class="mxinfo" id="T2:U163">0.0</span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="48,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo" id="T2:U164"><span class="mxinfo" id="T2:U165"><span class="var type1" id="S3T1U258">satrec</span>.isimp</span> = <span class="mxinfo" id="T2:U167">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,138" id="srcline138">138</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U168"><span class="var type1" id="S18T2U265">rp</span> &lt; (<span class="mxinfo" id="T2:U170"><span class="mxinfo" id="T2:U171"><span class="mxinfo" id="T2:U172">220.0</span> / <span class="mxinfo" id="T2:U173"><span class="var type1" id="S4T4U271">gravc</span>.radiusearthkm</span></span> + <span class="mxinfo" id="T2:U175">1.0</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,139" id="srcline139">139</a></span><span class="line">        <span class="mxinfo" id="T2:U176"><span class="mxinfo" id="T2:U177"><span class="var type1" id="S3T1U277">satrec</span>.isimp</span> = <span class="mxinfo" id="T2:U179">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,140" id="srcline140">140</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo" id="T2:U180"><span class="var type1" id="S22T2U282">sfour</span>  = <span class="var type1" id="S5T2U283">ss</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo" id="T2:U183"><span class="var type1" id="S23T2U286">qzms24</span> = <span class="var type1" id="S6T2U287">qzms2t</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo" id="T2:U186"><span class="var type1" id="S24T2U290">perige</span> = <span class="mxinfo" id="T2:U188">(<span class="mxinfo" id="T2:U189"><span class="var type1" id="S18T2U294">rp</span> - <span class="mxinfo" id="T2:U191">1.0</span></span>) * <span class="mxinfo" id="T2:U192"><span class="var type1" id="S4T4U297">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,144" id="srcline144">144</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="48,145" id="srcline145">145</a></span><span class="line">    <span class="comment">% /* - for perigees below 156 km, s and qoms2t are altered - */</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,146" id="srcline146">146</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U194"><span class="var type1" id="S24T2U303">perige</span> &lt; <span class="mxinfo" id="T2:U196">156.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,147" id="srcline147">147</a></span><span class="line">        <span class="mxinfo" id="T2:U197"><span class="var type1" id="S22T2U307">sfour</span> = <span class="mxinfo" id="T2:U199"><span class="var type1" id="S24T2U309">perige</span> - <span class="mxinfo" id="T2:U201">78.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,148" id="srcline148">148</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T5:U202"><span class="var type1" id="S24T2U315">perige</span> &lt; <span class="mxinfo" id="T2:U204">98.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,149" id="srcline149">149</a></span><span class="line">            <span class="mxinfo" id="T2:U205"><span class="var type1" id="S22T2U319">sfour</span> = <span class="mxinfo" id="T2:U207">20.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,150" id="srcline150">150</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,151" id="srcline151">151</a></span><span class="line">        <span class="mxinfo" id="T2:U208"><span class="var type1" id="S23T2U323">qzms24</span> = <span class="mxinfo" id="T2:U210">(<span class="mxinfo" id="T2:U211">(<span class="mxinfo" id="T2:U212"><span class="mxinfo" id="T2:U213">120.0</span> - <span class="var type1" id="S22T2U330">sfour</span></span>) / <span class="mxinfo" id="T2:U215"><span class="var type1" id="S4T4U332">gravc</span>.radiusearthkm</span></span>)^4.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,152" id="srcline152">152</a></span><span class="line">        <span class="mxinfo" id="T2:U217"><span class="var type1" id="S22T2U337">sfour</span>  = <span class="mxinfo" id="T2:U219"><span class="mxinfo" id="T2:U220"><span class="var type1" id="S22T2U340">sfour</span> / <span class="mxinfo" id="T2:U222"><span class="var type1" id="S4T4U342">gravc</span>.radiusearthkm</span></span> + <span class="mxinfo" id="T2:U224">1.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,153" id="srcline153">153</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo" id="T2:U225"><span class="var type1" id="S25T2U347">pinvsq</span> = <span class="mxinfo" id="T2:U227"><span class="mxinfo" id="T2:U228">1.0</span> / <span class="var type1" id="S17T2U350">posq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,155" id="srcline155">155</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="48,156" id="srcline156">156</a></span><span class="line">    <span class="mxinfo" id="T2:U230"><span class="var type1" id="S26T2U353">tsi</span>  = <span class="mxinfo" id="T2:U232"><span class="mxinfo" id="T2:U233">1.0</span> / (<span class="mxinfo" id="T2:U234"><span class="var type1" id="S10T2U358">ao</span> - <span class="var type1" id="S22T2U359">sfour</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,157" id="srcline157">157</a></span><span class="line">    <span class="mxinfo" id="T2:U237"><span class="mxinfo" id="T2:U238"><span class="var type1" id="S3T1U363">satrec</span>.eta</span>  = <span class="mxinfo" id="T2:U240"><span class="mxinfo" id="T2:U241"><span class="var type1" id="S10T2U367">ao</span> * <span class="mxinfo" id="T2:U243"><span class="var type1" id="S3T1U369">satrec</span>.ecco</span></span> * <span class="var type1" id="S26T2U371">tsi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,158" id="srcline158">158</a></span><span class="line">    <span class="mxinfo" id="T2:U246"><span class="var type1" id="S27T2U374">etasq</span> = <span class="mxinfo" id="T2:U248"><span class="mxinfo" id="T2:U249"><span class="var type1" id="S3T1U377">satrec</span>.eta</span> * <span class="mxinfo" id="T2:U251"><span class="var type1" id="S3T1U380">satrec</span>.eta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,159" id="srcline159">159</a></span><span class="line">    <span class="mxinfo" id="T2:U253"><span class="var type1" id="S28T2U384">eeta</span>  = <span class="mxinfo" id="T2:U255"><span class="mxinfo" id="T2:U256"><span class="var type1" id="S3T1U387">satrec</span>.ecco</span> * <span class="mxinfo" id="T2:U258"><span class="var type1" id="S3T1U390">satrec</span>.eta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,160" id="srcline160">160</a></span><span class="line">    <span class="mxinfo" id="T2:U260"><span class="var type1" id="S29T2U394">psisq</span> = <span class="mxinfo" id="T2:U262">abs(<span class="mxinfo" id="T2:U263"><span class="mxinfo" id="T2:U264">1.0</span> - <span class="var type1" id="S27T2U399">etasq</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,161" id="srcline161">161</a></span><span class="line">    <span class="mxinfo" id="T2:U266"><span class="var type1" id="S31T2U402">coef</span>  = <span class="mxinfo" id="T2:U268"><span class="var type1" id="S23T2U404">qzms24</span> * <span class="mxinfo" id="T2:U270"><span class="var type1" id="S26T2U406">tsi</span>^4.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo" id="T2:U272"><span class="var type1" id="S32T2U410">coef1</span> = <span class="mxinfo" id="T2:U274"><span class="var type1" id="S31T2U412">coef</span> / <span class="mxinfo" id="T2:U276"><span class="var type1" id="S29T2U414">psisq</span>^3.5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,163" id="srcline163">163</a></span><span class="line">    <span class="mxinfo" id="T2:U278"><span class="var type1" id="S33T2U418">cc2</span>   = <span class="mxinfo" id="T2:U280"><span class="mxinfo" id="T2:U281"><span class="var type1" id="S32T2U421">coef1</span> * <span class="mxinfo" id="T2:U283"><span class="var type1" id="S3T1U423">satrec</span>.no</span></span> * (<span class="mxinfo" id="T2:U285"><span class="mxinfo" id="T2:U286"><span class="var type1" id="S10T2U428">ao</span> * (<span class="mxinfo" id="T2:U288"><span class="mxinfo" id="T2:U289"><span class="mxinfo" id="T2:U290">1.0</span> + <span class="mxinfo" id="T2:U291"><span class="mxinfo" id="T2:U292">1.5</span> * <span class="var type1" id="S27T2U435">etasq</span></span></span> + <span class="mxinfo" id="T2:U294"><span class="var type1" id="S28T2U437">eeta</span> *<span class="keyword">...</span></span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo" id="T2:U278"><span class="mxinfo" id="T2:U280"><span class="mxinfo" id="T2:U285"><span class="mxinfo" id="T2:U286"><span class="mxinfo" id="T2:U288"><span class="mxinfo" id="T2:U294">        (<span class="mxinfo" id="T2:U296"><span class="mxinfo" id="T2:U297">4.0</span> + <span class="var type1" id="S27T2U441">etasq</span></span>)</span></span>)</span> + <span class="mxinfo" id="T2:U299"><span class="mxinfo" id="T2:U300"><span class="mxinfo" id="T2:U301"><span class="mxinfo" id="T2:U302"><span class="mxinfo" id="T2:U303"><span class="mxinfo" id="T2:U304">0.375</span> * <span class="mxinfo" id="T2:U305"><span class="var type1" id="S4T4U449">gravc</span>.j2</span></span> * <span class="var type1" id="S26T2U451">tsi</span></span> / <span class="var type1" id="S29T2U452">psisq</span></span> * <span class="mxinfo" id="T2:U309"><span class="var type1" id="S3T1U454">satrec</span>.con41</span></span> *<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo" id="T2:U278"><span class="mxinfo" id="T2:U280"><span class="mxinfo" id="T2:U285"><span class="mxinfo" id="T2:U299">        (<span class="mxinfo" id="T2:U311"><span class="mxinfo" id="T2:U312">8.0</span> + <span class="mxinfo" id="T2:U313"><span class="mxinfo" id="T2:U314"><span class="mxinfo" id="T2:U315">3.0</span> * <span class="var type1" id="S27T2U462">etasq</span></span> * (<span class="mxinfo" id="T2:U317"><span class="mxinfo" id="T2:U318">8.0</span> + <span class="var type1" id="S27T2U466">etasq</span></span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,166" id="srcline166">166</a></span><span class="line">    <span class="mxinfo" id="T2:U320"><span class="mxinfo" id="T2:U321"><span class="var type1" id="S3T1U470">satrec</span>.cc1</span>   = <span class="mxinfo" id="T2:U323"><span class="mxinfo" id="T2:U324"><span class="var type1" id="S3T1U474">satrec</span>.bstar</span> * <span class="var type1" id="S33T2U476">cc2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,167" id="srcline167">167</a></span><span class="line">    <span class="mxinfo" id="T2:U327"><span class="var type1" id="S34T2U479">cc3</span>   = <span class="mxinfo" id="T2:U329">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,168" id="srcline168">168</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U330"><span class="mxinfo" id="T2:U331"><span class="var type1" id="S3T1U486">satrec</span>.ecco</span> &gt; <span class="mxinfo" id="T2:U333">1.0e-4</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,169" id="srcline169">169</a></span><span class="line">        <span class="mxinfo" id="T2:U334"><span class="var type1" id="S34T2U491">cc3</span> = <span class="mxinfo" id="T2:U336"><span class="mxinfo" id="T2:U337"><span class="mxinfo" id="T2:U338"><span class="mxinfo" id="T2:U339"><span class="mxinfo" id="T2:U340"><span class="mxinfo" id="T2:U341"><span class="mxinfo" id="T2:U342">-2.0</span> * <span class="var type1" id="S31T2U500">coef</span></span> * <span class="var type1" id="S26T2U501">tsi</span></span> * <span class="mxinfo" id="T2:U345"><span class="var type1" id="S4T4U503">gravc</span>.j3oj2</span></span> * <span class="mxinfo" id="T2:U347"><span class="var type1" id="S3T1U506">satrec</span>.no</span></span> * <span class="var type1" id="S20T2U508">sinio</span></span> / <span class="mxinfo" id="T2:U350"><span class="var type1" id="S3T1U510">satrec</span>.ecco</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,170" id="srcline170">170</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,171" id="srcline171">171</a></span><span class="line">    <span class="mxinfo" id="T2:U352"><span class="mxinfo" id="T2:U353"><span class="var type1" id="S3T1U515">satrec</span>.x1mth2</span> = <span class="mxinfo" id="T2:U355"><span class="mxinfo" id="T2:U356">1.0</span> - <span class="var type1" id="S13T2U519">cosio2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,172" id="srcline172">172</a></span><span class="line">    <span class="mxinfo" id="T2:U358"><span class="mxinfo" id="T2:U359"><span class="var type1" id="S3T1U523">satrec</span>.cc4</span>    = <span class="mxinfo" id="T2:U361"><span class="mxinfo" id="T2:U362"><span class="mxinfo" id="T2:U363"><span class="mxinfo" id="T2:U364"><span class="mxinfo" id="T2:U365"><span class="mxinfo" id="T2:U366">2.0</span>* <span class="mxinfo" id="T2:U367"><span class="var type1" id="S3T1U532">satrec</span>.no</span></span> * <span class="var type1" id="S32T2U534">coef1</span></span> * <span class="var type1" id="S10T2U535">ao</span></span> * <span class="var type1" id="S16T2U536">omeosq</span></span> *<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T2:U358"><span class="mxinfo" id="T2:U361">        (<span class="mxinfo" id="T2:U372"><span class="mxinfo" id="T2:U373"><span class="mxinfo" id="T2:U374"><span class="mxinfo" id="T2:U375"><span class="var type1" id="S3T1U542">satrec</span>.eta</span> * (<span class="mxinfo" id="T2:U377"><span class="mxinfo" id="T2:U378">2.0</span> + <span class="mxinfo" id="T2:U379"><span class="mxinfo" id="T2:U380">0.5</span> * <span class="var type1" id="S27T2U549">etasq</span></span></span>)</span> + <span class="mxinfo" id="T2:U382"><span class="mxinfo" id="T2:U383"><span class="var type1" id="S3T1U552">satrec</span>.ecco</span> *<span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T2:U358"><span class="mxinfo" id="T2:U361"><span class="mxinfo" id="T2:U372"><span class="mxinfo" id="T2:U373"><span class="mxinfo" id="T2:U382">        (<span class="mxinfo" id="T2:U385"><span class="mxinfo" id="T2:U386">0.5</span> + <span class="mxinfo" id="T2:U387"><span class="mxinfo" id="T2:U388">2.0</span> * <span class="var type1" id="S27T2U559">etasq</span></span></span>)</span></span> - <span class="mxinfo" id="T2:U390"><span class="mxinfo" id="T2:U391"><span class="mxinfo" id="T2:U392"><span class="mxinfo" id="T2:U393"><span class="var type1" id="S4T4U564">gravc</span>.j2</span> * <span class="var type1" id="S26T2U566">tsi</span></span> / (<span class="mxinfo" id="T2:U396"><span class="var type1" id="S10T2U569">ao</span> * <span class="var type1" id="S29T2U570">psisq</span></span>)</span> *<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,175" id="srcline175">175</a></span><span class="line"><span class="mxinfo" id="T2:U358"><span class="mxinfo" id="T2:U361"><span class="mxinfo" id="T2:U372"><span class="mxinfo" id="T2:U390">        (<span class="mxinfo" id="T2:U399"><span class="mxinfo" id="T2:U400"><span class="mxinfo" id="T2:U401"><span class="mxinfo" id="T2:U402">-3.0</span> * <span class="mxinfo" id="T2:U403"><span class="var type1" id="S3T1U578">satrec</span>.con41</span></span> * (<span class="mxinfo" id="T2:U405"><span class="mxinfo" id="T2:U406"><span class="mxinfo" id="T2:U407">1.0</span> - <span class="mxinfo" id="T2:U408"><span class="mxinfo" id="T2:U409">2.0</span> * <span class="var type1" id="S28T2U586">eeta</span></span></span> + <span class="mxinfo" id="T2:U411"><span class="var type1" id="S27T2U588">etasq</span> *<span class="keyword">...</span></span></span></span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo" id="T2:U358"><span class="mxinfo" id="T2:U361"><span class="mxinfo" id="T2:U372"><span class="mxinfo" id="T2:U390"><span class="mxinfo" id="T2:U399"><span class="mxinfo" id="T2:U400"><span class="mxinfo" id="T2:U405"><span class="mxinfo" id="T2:U411">        (<span class="mxinfo" id="T2:U413"><span class="mxinfo" id="T2:U414">1.5</span> - <span class="mxinfo" id="T2:U415"><span class="mxinfo" id="T2:U416">0.5</span> * <span class="var type1" id="S28T2U594">eeta</span></span></span>)</span></span>)</span> + <span class="mxinfo" id="T2:U418"><span class="mxinfo" id="T2:U419"><span class="mxinfo" id="T2:U420"><span class="mxinfo" id="T2:U421">0.75</span> * <span class="mxinfo" id="T2:U422"><span class="var type1" id="S3T1U600">satrec</span>.x1mth2</span></span> *<span class="keyword">...</span></span></span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,177" id="srcline177">177</a></span><span class="line"><span class="mxinfo" id="T2:U358"><span class="mxinfo" id="T2:U361"><span class="mxinfo" id="T2:U372"><span class="mxinfo" id="T2:U390"><span class="mxinfo" id="T2:U399"><span class="mxinfo" id="T2:U418"><span class="mxinfo" id="T2:U419">        (<span class="mxinfo" id="T2:U424"><span class="mxinfo" id="T2:U425"><span class="mxinfo" id="T2:U426">2.0</span> * <span class="var type1" id="S27T2U606">etasq</span></span> - <span class="mxinfo" id="T2:U428"><span class="var type1" id="S28T2U608">eeta</span> * (<span class="mxinfo" id="T2:U430"><span class="mxinfo" id="T2:U431">1.0</span> + <span class="var type1" id="S27T2U612">etasq</span></span>)</span></span>)</span> * <span class="mxinfo" id="T2:U433">cos(<span class="mxinfo" id="T2:U434"><span class="mxinfo" id="T2:U435">2.0</span> * <span class="mxinfo" id="T2:U436"><span class="var type1" id="S3T1U618">satrec</span>.argpo</span></span>)</span></span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,178" id="srcline178">178</a></span><span class="line">    <span class="mxinfo" id="T2:U438"><span class="mxinfo" id="T2:U439"><span class="var type1" id="S3T1U623">satrec</span>.cc5</span> = <span class="mxinfo" id="T2:U441"><span class="mxinfo" id="T2:U442"><span class="mxinfo" id="T2:U443"><span class="mxinfo" id="T2:U444"><span class="mxinfo" id="T2:U445">2.0</span> * <span class="var type1" id="S32T2U630">coef1</span></span> * <span class="var type1" id="S10T2U631">ao</span></span> * <span class="var type1" id="S16T2U632">omeosq</span></span> * (<span class="mxinfo" id="T2:U449"><span class="mxinfo" id="T2:U450"><span class="mxinfo" id="T2:U451">1.0</span> + <span class="mxinfo" id="T2:U452"><span class="mxinfo" id="T2:U453">2.75</span> *<span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,179" id="srcline179">179</a></span><span class="line"><span class="mxinfo" id="T2:U438"><span class="mxinfo" id="T2:U441"><span class="mxinfo" id="T2:U449"><span class="mxinfo" id="T2:U450"><span class="mxinfo" id="T2:U452">        (<span class="mxinfo" id="T2:U454"><span class="var type1" id="S27T2U641">etasq</span> + <span class="var type1" id="S28T2U642">eeta</span></span>)</span></span> + <span class="mxinfo" id="T2:U457"><span class="var type1" id="S28T2U644">eeta</span> * <span class="var type1" id="S27T2U645">etasq</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,180" id="srcline180">180</a></span><span class="line">    <span class="mxinfo" id="T2:U460"><span class="var type1" id="S36T2U648">cosio4</span> = <span class="mxinfo" id="T2:U462"><span class="var type1" id="S13T2U650">cosio2</span> * <span class="var type1" id="S13T2U651">cosio2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,181" id="srcline181">181</a></span><span class="line">    <span class="mxinfo" id="T2:U465"><span class="var type1" id="S37T2U654">temp1</span>  = <span class="mxinfo" id="T2:U467"><span class="mxinfo" id="T2:U468"><span class="mxinfo" id="T2:U469"><span class="mxinfo" id="T2:U470">1.5</span> * <span class="mxinfo" id="T2:U471"><span class="var type1" id="S4T4U660">gravc</span>.j2</span></span> * <span class="var type1" id="S25T2U662">pinvsq</span></span> * <span class="mxinfo" id="T2:U474"><span class="var type1" id="S3T1U664">satrec</span>.no</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,182" id="srcline182">182</a></span><span class="line">    <span class="mxinfo" id="T2:U476"><span class="var type1" id="S38T2U668">temp2</span>  = <span class="mxinfo" id="T2:U478"><span class="mxinfo" id="T2:U479"><span class="mxinfo" id="T2:U480"><span class="mxinfo" id="T2:U481">0.5</span> * <span class="var type1" id="S37T2U673">temp1</span></span> * <span class="mxinfo" id="T2:U483"><span class="var type1" id="S4T4U675">gravc</span>.j2</span></span> * <span class="var type1" id="S25T2U677">pinvsq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,183" id="srcline183">183</a></span><span class="line">    <span class="mxinfo" id="T2:U486"><span class="var type1" id="S39T2U680">temp3</span>  = <span class="mxinfo" id="T2:U488"><span class="mxinfo" id="T2:U489"><span class="mxinfo" id="T2:U490"><span class="mxinfo" id="T2:U491"><span class="mxinfo" id="T2:U492">-0.46875</span> * <span class="mxinfo" id="T2:U493"><span class="var type1" id="S4T4U688">gravc</span>.j4</span></span> * <span class="var type1" id="S25T2U690">pinvsq</span></span> * <span class="var type1" id="S25T2U691">pinvsq</span></span> * <span class="mxinfo" id="T2:U497"><span class="var type1" id="S3T1U693">satrec</span>.no</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,184" id="srcline184">184</a></span><span class="line">    <span class="mxinfo" id="T2:U499"><span class="mxinfo" id="T2:U500"><span class="var type1" id="S3T1U698">satrec</span>.mdot</span>     = <span class="mxinfo" id="T2:U502"><span class="mxinfo" id="T2:U503"><span class="mxinfo" id="T2:U504"><span class="var type1" id="S3T1U703">satrec</span>.no</span> + <span class="mxinfo" id="T2:U506"><span class="mxinfo" id="T2:U507"><span class="mxinfo" id="T2:U508"><span class="mxinfo" id="T2:U509">0.5</span> * <span class="var type1" id="S37T2U709">temp1</span></span> * <span class="var type1" id="S19T2U710">rteosq</span></span> * <span class="mxinfo" id="T2:U512"><span class="var type1" id="S3T1U712">satrec</span>.con41</span></span></span> +<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo" id="T2:U499"><span class="mxinfo" id="T2:U502">        <span class="mxinfo" id="T2:U514"><span class="mxinfo" id="T2:U515"><span class="mxinfo" id="T2:U516"><span class="mxinfo" id="T2:U517">0.0625</span> * <span class="var type1" id="S38T2U718">temp2</span></span> * <span class="var type1" id="S19T2U719">rteosq</span></span> * (<span class="mxinfo" id="T2:U520"><span class="mxinfo" id="T2:U521"><span class="mxinfo" id="T2:U522">13.0</span> - <span class="mxinfo" id="T2:U523"><span class="mxinfo" id="T2:U524">78.0</span> * <span class="var type1" id="S13T2U726">cosio2</span></span></span> + <span class="mxinfo" id="T2:U526"><span class="mxinfo" id="T2:U527">137.0</span> * <span class="var type1" id="S36T2U729">cosio4</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,186" id="srcline186">186</a></span><span class="line">    <span class="mxinfo" id="T2:U529"><span class="mxinfo" id="T2:U530"><span class="var type1" id="S3T1U733">satrec</span>.argpdot</span>  = <span class="mxinfo" id="T2:U532"><span class="mxinfo" id="T2:U533"><span class="mxinfo" id="T2:U534"><span class="mxinfo" id="T2:U535"><span class="mxinfo" id="T2:U536">-0.5</span> * <span class="var type1" id="S37T2U741">temp1</span></span> * <span class="var type1" id="S11T2U742">con42</span></span> + <span class="mxinfo" id="T2:U539"><span class="mxinfo" id="T2:U540"><span class="mxinfo" id="T2:U541">0.0625</span> * <span class="var type1" id="S38T2U746">temp2</span></span> *<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo" id="T2:U529"><span class="mxinfo" id="T2:U532"><span class="mxinfo" id="T2:U533"><span class="mxinfo" id="T2:U539">        (<span class="mxinfo" id="T2:U543"><span class="mxinfo" id="T2:U544"><span class="mxinfo" id="T2:U545">7.0</span> - <span class="mxinfo" id="T2:U546"><span class="mxinfo" id="T2:U547">114.0</span> * <span class="var type1" id="S13T2U753">cosio2</span></span></span> + <span class="mxinfo" id="T2:U549"><span class="mxinfo" id="T2:U550">395.0</span> * <span class="var type1" id="S36T2U756">cosio4</span></span></span>)</span></span> +<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T2:U529"><span class="mxinfo" id="T2:U532">        <span class="mxinfo" id="T2:U552"><span class="var type1" id="S39T2U758">temp3</span> * (<span class="mxinfo" id="T2:U554"><span class="mxinfo" id="T2:U555"><span class="mxinfo" id="T2:U556">3.0</span> - <span class="mxinfo" id="T2:U557"><span class="mxinfo" id="T2:U558">36.0</span> * <span class="var type1" id="S13T2U765">cosio2</span></span></span> + <span class="mxinfo" id="T2:U560"><span class="mxinfo" id="T2:U561">49.0</span> * <span class="var type1" id="S36T2U768">cosio4</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,189" id="srcline189">189</a></span><span class="line">    <span class="mxinfo" id="T2:U563"><span class="var type1" id="S40T2U771">xhdot1</span>            = <span class="mxinfo" id="T2:U565"><span class="mxinfo" id="T2:U566">-<span class="var type1" id="S37T2U774">temp1</span></span> * <span class="var type1" id="S12T2U775">cosio</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,190" id="srcline190">190</a></span><span class="line">    <span class="mxinfo" id="T2:U569"><span class="mxinfo" id="T2:U570"><span class="var type1" id="S3T1U779">satrec</span>.nodedot</span> = <span class="mxinfo" id="T2:U572"><span class="var type1" id="S40T2U782">xhdot1</span> + <span class="mxinfo" id="T2:U574">(<span class="mxinfo" id="T2:U575"><span class="mxinfo" id="T2:U576"><span class="mxinfo" id="T2:U577"><span class="mxinfo" id="T2:U578">0.5</span> * <span class="var type1" id="S38T2U789">temp2</span></span> * (<span class="mxinfo" id="T2:U580"><span class="mxinfo" id="T2:U581">4.0</span> - <span class="mxinfo" id="T2:U582"><span class="mxinfo" id="T2:U583">19.0</span> * <span class="var type1" id="S13T2U795">cosio2</span></span></span>)</span> +<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo" id="T2:U569"><span class="mxinfo" id="T2:U572"><span class="mxinfo" id="T2:U574"><span class="mxinfo" id="T2:U575">        <span class="mxinfo" id="T2:U585"><span class="mxinfo" id="T2:U586"><span class="mxinfo" id="T2:U587">2.0</span> * <span class="var type1" id="S39T2U799">temp3</span></span> * (<span class="mxinfo" id="T2:U589"><span class="mxinfo" id="T2:U590">3.0</span> - <span class="mxinfo" id="T2:U591"><span class="mxinfo" id="T2:U592">7.0</span> * <span class="var type1" id="S13T2U805">cosio2</span></span></span>)</span></span>) * <span class="var type1" id="S12T2U806">cosio</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,192" id="srcline192">192</a></span><span class="line">    <span class="mxinfo" id="T2:U595"><span class="var type1" id="S41T2U809">xpidot</span>            =  <span class="mxinfo" id="T2:U597"><span class="mxinfo" id="T2:U598"><span class="var type1" id="S3T1U812">satrec</span>.argpdot</span>+ <span class="mxinfo" id="T2:U600"><span class="var type1" id="S3T1U815">satrec</span>.nodedot</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,193" id="srcline193">193</a></span><span class="line">    <span class="mxinfo" id="T2:U602"><span class="mxinfo" id="T2:U603"><span class="var type1" id="S3T1U820">satrec</span>.omgcof</span>   = <span class="mxinfo" id="T2:U605"><span class="mxinfo" id="T2:U606"><span class="mxinfo" id="T2:U607"><span class="var type1" id="S3T1U825">satrec</span>.bstar</span> * <span class="var type1" id="S34T2U827">cc3</span></span> * <span class="mxinfo" id="T2:U610">cos(<span class="mxinfo" id="T2:U611"><span class="var type1" id="S3T1U831">satrec</span>.argpo</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,194" id="srcline194">194</a></span><span class="line">    <span class="mxinfo" id="T2:U613"><span class="mxinfo" id="T2:U614"><span class="var type1" id="S3T1U836">satrec</span>.xmcof</span>    = <span class="mxinfo" id="T2:U616">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,195" id="srcline195">195</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U617"><span class="mxinfo" id="T2:U618"><span class="var type1" id="S3T1U844">satrec</span>.ecco</span> &gt; <span class="mxinfo" id="T2:U620">1.0e-4</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,196" id="srcline196">196</a></span><span class="line">        <span class="mxinfo" id="T2:U621"><span class="mxinfo" id="T2:U622"><span class="var type1" id="S3T1U850">satrec</span>.xmcof</span> = <span class="mxinfo" id="T2:U624"><span class="mxinfo" id="T2:U625"><span class="mxinfo" id="T2:U626"><span class="mxinfo" id="T2:U627">-<span class="var type1" id="S7T2U856">x2o3</span></span> * <span class="var type1" id="S31T2U857">coef</span></span> * <span class="mxinfo" id="T2:U630"><span class="var type1" id="S3T1U859">satrec</span>.bstar</span></span> / <span class="var type1" id="S28T2U861">eeta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,197" id="srcline197">197</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,198" id="srcline198">198</a></span><span class="line">    <span class="mxinfo" id="T2:U633"><span class="mxinfo" id="T2:U634"><span class="var type1" id="S3T1U865">satrec</span>.nodecf</span> = <span class="mxinfo" id="T2:U636"><span class="mxinfo" id="T2:U637"><span class="mxinfo" id="T2:U638"><span class="mxinfo" id="T2:U639">3.5</span> * <span class="var type1" id="S16T2U871">omeosq</span></span> * <span class="var type1" id="S40T2U872">xhdot1</span></span> * <span class="mxinfo" id="T2:U642"><span class="var type1" id="S3T1U874">satrec</span>.cc1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,199" id="srcline199">199</a></span><span class="line">    <span class="mxinfo" id="T2:U644"><span class="mxinfo" id="T2:U645"><span class="var type1" id="S3T1U879">satrec</span>.t2cof</span>   = <span class="mxinfo" id="T2:U647"><span class="mxinfo" id="T2:U648">1.5</span> * <span class="mxinfo" id="T2:U649"><span class="var type1" id="S3T1U884">satrec</span>.cc1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,200" id="srcline200">200</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="48,201" id="srcline201">201</a></span><span class="line">    <span class="comment">% // sgp4fix for divide by zero with xinco = 180 deg</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,202" id="srcline202">202</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U651"><span class="mxinfo" id="T2:U652">abs(<span class="mxinfo" id="T2:U653"><span class="var type1" id="S12T2U893">cosio</span>+<span class="mxinfo" id="T2:U655">1.0</span></span>)</span> &gt; <span class="mxinfo" id="T2:U656">1.5e-12</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,203" id="srcline203">203</a></span><span class="line">        <span class="mxinfo" id="T2:U657"><span class="mxinfo" id="T2:U658"><span class="var type1" id="S3T1U899">satrec</span>.xlcof</span>   = <span class="mxinfo" id="T2:U660"><span class="mxinfo" id="T2:U661"><span class="mxinfo" id="T2:U662"><span class="mxinfo" id="T2:U663"><span class="mxinfo" id="T2:U664">-0.25</span> * <span class="mxinfo" id="T2:U665"><span class="var type1" id="S4T4U908">gravc</span>.j3oj2</span></span> * <span class="var type1" id="S20T2U910">sinio</span></span> *<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,204" id="srcline204">204</a></span><span class="line"><span class="mxinfo" id="T2:U657"><span class="mxinfo" id="T2:U660"><span class="mxinfo" id="T2:U661">            (<span class="mxinfo" id="T2:U668"><span class="mxinfo" id="T2:U669">3.0</span> + <span class="mxinfo" id="T2:U670"><span class="mxinfo" id="T2:U671">5.0</span> * <span class="var type1" id="S12T2U916">cosio</span></span></span>)</span> / (<span class="mxinfo" id="T2:U673"><span class="mxinfo" id="T2:U674">1.0</span> + <span class="var type1" id="S12T2U920">cosio</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,205" id="srcline205">205</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,206" id="srcline206">206</a></span><span class="line">        <span class="mxinfo" id="T2:U676"><span class="mxinfo" id="T2:U677"><span class="var type1" id="S3T1U925">satrec</span>.xlcof</span>   = <span class="mxinfo" id="T2:U679"><span class="mxinfo" id="T2:U680"><span class="mxinfo" id="T2:U681"><span class="mxinfo" id="T2:U682"><span class="mxinfo" id="T2:U683">-0.25</span> * <span class="mxinfo" id="T2:U684"><span class="var type1" id="S4T4U934">gravc</span>.j3oj2</span></span> * <span class="var type1" id="S20T2U936">sinio</span></span> *<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,207" id="srcline207">207</a></span><span class="line"><span class="mxinfo" id="T2:U676"><span class="mxinfo" id="T2:U679"><span class="mxinfo" id="T2:U680">            (<span class="mxinfo" id="T2:U687"><span class="mxinfo" id="T2:U688">3.0</span> + <span class="mxinfo" id="T2:U689"><span class="mxinfo" id="T2:U690">5.0</span> * <span class="var type1" id="S12T2U942">cosio</span></span></span>)</span> / <span class="mxinfo" id="T2:U692"><span class="var type1" id="S8T2U943">temp4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,208" id="srcline208">208</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,209" id="srcline209">209</a></span><span class="line">    <span class="mxinfo" id="T2:U694"><span class="mxinfo" id="T2:U695"><span class="var type1" id="S3T1U947">satrec</span>.aycof</span>   = <span class="mxinfo" id="T2:U697"><span class="mxinfo" id="T2:U698"><span class="mxinfo" id="T2:U699">-0.5</span> * <span class="mxinfo" id="T2:U700"><span class="var type1" id="S4T4U954">gravc</span>.j3oj2</span></span> * <span class="var type1" id="S20T2U956">sinio</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,210" id="srcline210">210</a></span><span class="line">    <span class="mxinfo" id="T2:U703"><span class="mxinfo" id="T2:U704"><span class="var type1" id="S3T1U960">satrec</span>.delmo</span>   = <span class="mxinfo" id="T2:U706">(<span class="mxinfo" id="T2:U707"><span class="mxinfo" id="T2:U708">1.0</span> + <span class="mxinfo" id="T2:U709"><span class="mxinfo" id="T2:U710"><span class="var type1" id="S3T1U968">satrec</span>.eta</span> * <span class="mxinfo" id="T2:U712">cos(<span class="mxinfo" id="T2:U713"><span class="var type1" id="S3T1U973">satrec</span>.mo</span>)</span></span></span>)^3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,211" id="srcline211">211</a></span><span class="line">    <span class="mxinfo" id="T2:U715"><span class="mxinfo" id="T2:U716"><span class="var type1" id="S3T1U979">satrec</span>.sinmao</span>  = <span class="mxinfo" id="T2:U718">sin(<span class="mxinfo" id="T2:U719"><span class="var type1" id="S3T1U984">satrec</span>.mo</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,212" id="srcline212">212</a></span><span class="line">    <span class="mxinfo" id="T2:U721"><span class="mxinfo" id="T2:U722"><span class="var type1" id="S3T1U989">satrec</span>.x7thm1</span>  = <span class="mxinfo" id="T2:U724"><span class="mxinfo" id="T2:U725"><span class="mxinfo" id="T2:U726">7.0</span> * <span class="var type1" id="S13T2U994">cosio2</span></span> - <span class="mxinfo" id="T2:U728">1.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,213" id="srcline213">213</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="48,214" id="srcline214">214</a></span><span class="line"> <span class="comment">% Deep space inititiation removed since satellite orbit period will not</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,215" id="srcline215">215</a></span><span class="line"> <span class="comment">% require a deep space model.</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,216" id="srcline216">216</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="48,217" id="srcline217">217</a></span><span class="line"> <span class="comment">% Set variables for non deep space model.</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,218" id="srcline218">218</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U729"><span class="mxinfo" id="T2:U730"><span class="var type1" id="S3T1U1001">satrec</span>.isimp</span> ~= <span class="mxinfo" id="T2:U732">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="48,219" id="srcline219">219</a></span><span class="line">        <span class="mxinfo" id="T2:U733"><span class="var type1" id="S43T2U1006">cc1sq</span> = <span class="mxinfo" id="T2:U735"><span class="mxinfo" id="T2:U736"><span class="var type1" id="S3T1U1009">satrec</span>.cc1</span> * <span class="mxinfo" id="T2:U738"><span class="var type1" id="S3T1U1012">satrec</span>.cc1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,220" id="srcline220">220</a></span><span class="line">        <span class="mxinfo" id="T2:U740"><span class="mxinfo" id="T2:U741"><span class="var type1" id="S3T1U1017">satrec</span>.d2</span> = <span class="mxinfo" id="T2:U743"><span class="mxinfo" id="T2:U744"><span class="mxinfo" id="T2:U745"><span class="mxinfo" id="T2:U746">4.0</span> * <span class="var type1" id="S10T2U1023">ao</span></span> * <span class="var type1" id="S26T2U1024">tsi</span></span> * <span class="var type1" id="S43T2U1025">cc1sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,221" id="srcline221">221</a></span><span class="line">        <span class="mxinfo" id="T2:U750"><span class="var type1" id="S44T2U1028">temp</span> = <span class="mxinfo" id="T2:U752"><span class="mxinfo" id="T2:U753"><span class="mxinfo" id="T2:U754"><span class="mxinfo" id="T2:U755"><span class="var type1" id="S3T1U1033">satrec</span>.d2</span> * <span class="var type1" id="S26T2U1035">tsi</span></span> * <span class="mxinfo" id="T2:U758"><span class="var type1" id="S3T1U1037">satrec</span>.cc1</span></span> / <span class="mxinfo" id="T2:U760">3.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,222" id="srcline222">222</a></span><span class="line">        <span class="mxinfo" id="T2:U761"><span class="mxinfo" id="T2:U762"><span class="var type1" id="S3T1U1043">satrec</span>.d3</span> = <span class="mxinfo" id="T2:U764">(<span class="mxinfo" id="T2:U765"><span class="mxinfo" id="T2:U766"><span class="mxinfo" id="T2:U767">17.0</span> * <span class="var type1" id="S10T2U1050">ao</span></span> + <span class="var type1" id="S22T2U1051">sfour</span></span>) * <span class="var type1" id="S44T2U1052">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,223" id="srcline223">223</a></span><span class="line">        <span class="mxinfo" id="T2:U771"><span class="mxinfo" id="T2:U772"><span class="var type1" id="S3T1U1056">satrec</span>.d4</span> = <span class="mxinfo" id="T2:U774"><span class="mxinfo" id="T2:U775"><span class="mxinfo" id="T2:U776"><span class="mxinfo" id="T2:U777"><span class="mxinfo" id="T2:U778"><span class="mxinfo" id="T2:U779">0.5</span> * <span class="var type1" id="S44T2U1064">temp</span></span> * <span class="var type1" id="S10T2U1065">ao</span></span> * <span class="var type1" id="S26T2U1066">tsi</span></span> *<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,224" id="srcline224">224</a></span><span class="line"><span class="mxinfo" id="T2:U771"><span class="mxinfo" id="T2:U774"><span class="mxinfo" id="T2:U775">            (<span class="mxinfo" id="T2:U783"><span class="mxinfo" id="T2:U784"><span class="mxinfo" id="T2:U785">221.0</span> * <span class="var type1" id="S10T2U1071">ao</span></span> + <span class="mxinfo" id="T2:U787"><span class="mxinfo" id="T2:U788">31.0</span> * <span class="var type1" id="S22T2U1074">sfour</span></span></span>)</span> * <span class="mxinfo" id="T2:U790"><span class="var type1" id="S3T1U1076">satrec</span>.cc1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,225" id="srcline225">225</a></span><span class="line">        <span class="mxinfo" id="T2:U792"><span class="mxinfo" id="T2:U793"><span class="var type1" id="S3T1U1081">satrec</span>.t3cof</span> = <span class="mxinfo" id="T2:U795"><span class="mxinfo" id="T2:U796"><span class="var type1" id="S3T1U1085">satrec</span>.d2</span> + <span class="mxinfo" id="T2:U798"><span class="mxinfo" id="T2:U799">2.0</span> * <span class="var type1" id="S43T2U1089">cc1sq</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,226" id="srcline226">226</a></span><span class="line">        <span class="mxinfo" id="T2:U801"><span class="mxinfo" id="T2:U802"><span class="var type1" id="S3T1U1093">satrec</span>.t4cof</span> = <span class="mxinfo" id="T2:U804"><span class="mxinfo" id="T2:U805">0.25</span> * (<span class="mxinfo" id="T2:U806"><span class="mxinfo" id="T2:U807"><span class="mxinfo" id="T2:U808">3.0</span> * <span class="mxinfo" id="T2:U809"><span class="var type1" id="S3T1U1102">satrec</span>.d3</span></span> + <span class="mxinfo" id="T2:U811"><span class="mxinfo" id="T2:U812"><span class="var type1" id="S3T1U1106">satrec</span>.cc1</span> *<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,227" id="srcline227">227</a></span><span class="line"><span class="mxinfo" id="T2:U801"><span class="mxinfo" id="T2:U804"><span class="mxinfo" id="T2:U806"><span class="mxinfo" id="T2:U811">            (<span class="mxinfo" id="T2:U814"><span class="mxinfo" id="T2:U815"><span class="mxinfo" id="T2:U816">12.0</span> * <span class="mxinfo" id="T2:U817"><span class="var type1" id="S3T1U1113">satrec</span>.d2</span></span> + <span class="mxinfo" id="T2:U819"><span class="mxinfo" id="T2:U820">10.0</span> * <span class="var type1" id="S43T2U1117">cc1sq</span></span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,228" id="srcline228">228</a></span><span class="line">        <span class="mxinfo" id="T2:U822"><span class="mxinfo" id="T2:U823"><span class="var type1" id="S3T1U1121">satrec</span>.t5cof</span> = <span class="mxinfo" id="T2:U825"><span class="mxinfo" id="T2:U826">0.2</span> * (<span class="mxinfo" id="T2:U827"><span class="mxinfo" id="T2:U828"><span class="mxinfo" id="T2:U829"><span class="mxinfo" id="T2:U830"><span class="mxinfo" id="T2:U831">3.0</span> * <span class="mxinfo" id="T2:U832"><span class="var type1" id="S3T1U1132">satrec</span>.d4</span></span> +<span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,229" id="srcline229">229</a></span><span class="line"><span class="mxinfo" id="T2:U822"><span class="mxinfo" id="T2:U825"><span class="mxinfo" id="T2:U827"><span class="mxinfo" id="T2:U828"><span class="mxinfo" id="T2:U829">            <span class="mxinfo" id="T2:U834"><span class="mxinfo" id="T2:U835"><span class="mxinfo" id="T2:U836">12.0</span> * <span class="mxinfo" id="T2:U837"><span class="var type1" id="S3T1U1138">satrec</span>.cc1</span></span> * <span class="mxinfo" id="T2:U839"><span class="var type1" id="S3T1U1141">satrec</span>.d3</span></span></span> +<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,230" id="srcline230">230</a></span><span class="line"><span class="mxinfo" id="T2:U822"><span class="mxinfo" id="T2:U825"><span class="mxinfo" id="T2:U827"><span class="mxinfo" id="T2:U828">            <span class="mxinfo" id="T2:U841"><span class="mxinfo" id="T2:U842"><span class="mxinfo" id="T2:U843">6.0</span> * <span class="mxinfo" id="T2:U844"><span class="var type1" id="S3T1U1147">satrec</span>.d2</span></span> * <span class="mxinfo" id="T2:U846"><span class="var type1" id="S3T1U1150">satrec</span>.d2</span></span></span> +<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,231" id="srcline231">231</a></span><span class="line"><span class="mxinfo" id="T2:U822"><span class="mxinfo" id="T2:U825"><span class="mxinfo" id="T2:U827">            <span class="mxinfo" id="T2:U848"><span class="mxinfo" id="T2:U849"><span class="mxinfo" id="T2:U850">15.0</span> * <span class="var type1" id="S43T2U1155">cc1sq</span></span> * (<span class="mxinfo" id="T2:U852"><span class="mxinfo" id="T2:U853"><span class="mxinfo" id="T2:U854">2.0</span> * <span class="mxinfo" id="T2:U855"><span class="var type1" id="S3T1U1161">satrec</span>.d2</span></span> + <span class="var type1" id="S43T2U1163">cc1sq</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,232" id="srcline232">232</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,233" id="srcline233">233</a></span><span class="line"><span class="keyword">end</span> <span class="comment">% // if omeosq = 0 <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="48,234" id="srcline234">234</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,235" id="srcline235">235</a></span><span class="line"><span class="comment">% Finally propogate to zero epoch to initialise all others.</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,236" id="srcline236">236</a></span><span class="line"><span class="comment">% sgp4fix take out check to let satellites process until they are actually</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,237" id="srcline237">237</a></span><span class="line"><span class="comment">% below earth surface</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,238" id="srcline238">238</a></span><span class="line"><span class="comment">%if(satrec.error == 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,239" id="srcline239">239</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,240" id="srcline240">240</a></span><span class="line"><span class="mxinfo" id="T22:U858">[<span class="mxinfo" id="T2:U859"><span class="mxinfo" id="T2:U860">~</span></span>, <span class="mxinfo" id="T2:U861"><span class="mxinfo" id="T2:U862">~</span></span>] = <span class="fcn" id="F103N10:B1170">sgp4</span>(<span class="mxinfo" id="T2:U863">0.0</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,241" id="srcline241">241</a></span><span class="line"><span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,242" id="srcline242">242</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,243" id="srcline243">243</a></span><span class="line"><span class="mxinfo" id="T3:U864"><span class="mxinfo" id="T3:U865"><span class="var type1" id="S3T1U1175">satrec</span>.init</span> = <span class="mxinfo" id="T3:U867"><span class="string">'n'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="48,244" id="srcline244">244</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,245" id="srcline245">245</a></span><span class="line"><span class="comment">% global idebug dbgfile</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,246" id="srcline246">246</a></span><span class="line"><span class="comment">% if idebug</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,247" id="srcline247">247</a></span><span class="line"><span class="comment">%     debug6;</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,248" id="srcline248">248</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="48,249" id="srcline249">249</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="48,250" id="srcline250">250</a></span><span class="line"><span class="keyword">return</span>;</span></span>
</pre>
