<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="47,1" id="srcline1">  1</a></span><span class="line"><span class="comment">% -----------------------------------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%                              procedure sgp4</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%  this procedure is the sgp4 prediction model from space command. this is an</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%    updated and combined version of sgp4 and sdp4, which were originally</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%    published separately in spacetrack report #3. this version follows the</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%    methodology from the aiaa paper (2006) describing the history and</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%    development of the code.</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% Author:</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   Jeff Beck</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   beckja@alumni.lehigh.edu</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%    current :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%               7 may 08  david vallado</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%                           update small eccentricity check</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%    changes :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%              16 nov 07  david vallado</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%                           misc fixes for better compliance</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%   1.0 (aug 7, 2006) - update for paper dav</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% original comments from Vallado C++ version:</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%   author        : david vallado                  719-573-2600   28 jun 2005</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%   inputs        :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%     satrec    - initialised structure from sgp4init() call.</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%     tsince    - time eince epoch (minutes)</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%   outputs       :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%     r           - position vector                     km</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%     v           - velocity                            km/sec</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%     return code - non-zero on error.</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%                    1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%                    2 - mean motion less than 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%                    3 - pert elements, ecc &lt; 0.0  or  ecc &gt; 1.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%                    4 - semi-latus rectum &lt; 0.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%                    5 - epoch elements are sub-orbital</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%                    6 - satellite has decayed</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%   locals        :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%     am          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%     axnl, aynl        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%     betal       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%     COSIM   , SINIM   , COSOMM  , SINOMM  , Cnod    , Snod    , Cos2u   ,</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%     Sin2u   , Coseo1  , Sineo1  , Cosi    , Sini    , Cosip   , Sinip   ,</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%     Cosisq  , Cossu   , Sinsu   , Cosu    , Sinu</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%     Delm        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%     Delomg      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%     Dndt        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%     Eccm        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%     EMSQ        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%     Ecose       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%     El2         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%     Eo1         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%     Eccp        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%     Esine       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%     Argpm       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%     Argpp       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%     Omgadf      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%     Pl          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%     R           -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%     RTEMSQ      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">%     Rdotl       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%     Rl          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%     Rvdot       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%     Rvdotl      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%     Su          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">%     T2  , T3   , T4    , Tc</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%     Tem5, Temp , Temp1 , Temp2  , Tempa  , Tempe  , Templ</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">%     U   , Ux   , Uy    , Uz     , Vx     , Vy     , Vz</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%     inclm       - inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%     mm          - mean anomaly</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%     nm          - mean motion</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%     nodem      - longi of ascending node</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">%     xinc        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%     xincp       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%     xl          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">%     xlm         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%     mp          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">%     xmdf        -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">%     xmx         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">%     xmy         -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%     nodedf     -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">%     xnode       -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">%     nodep      -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">%     np          -</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%   coupling      :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">%     getgravconst</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%     dpper</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">%     dspace</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%   references    :</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%     hoots, roehrich, norad spacetrack report #3 1980</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">%     hoots, norad spacetrack report #6 1986</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,95" id="srcline95"> 95</a></span><span class="line"><span class="comment">%     hoots, schumacher and glover 2004</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,96" id="srcline96"> 96</a></span><span class="line"><span class="comment">%     vallado, crawford, hujsak, kelso  2006</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,97" id="srcline97"> 97</a></span><span class="line"><span class="comment">%  ----------------------------------------------------------------------------*/</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,99" id="srcline99"> 99</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T22U3">r</span>, <span class="var type1" id="S3T22U4">v</span>] = sgp4(<span class="var type1" id="S4T2U7">tsince</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="47,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,101" id="srcline101">101</a></span><span class="line"><span class="comment">%% Define Constants</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,102" id="srcline102">102</a></span><span class="line"><span class="mxinfo" id="T2:U4"><span class="var type1" id="S5T2U10">twopi</span> = <span class="mxinfo" id="T2:U6">2.0 * pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo" id="T2:U7"><span class="var type1" id="S7T2U17">x2o3</span>  = <span class="mxinfo" id="T2:U9">2.0 / 3.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,104" id="srcline104">104</a></span><span class="line"><span class="comment">% sgp4fix divisor for divide by zero check on inclination</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,105" id="srcline105">105</a></span><span class="line"><span class="comment">% the old check used 1.0 + cos(pi-1.0e-9), but then compared it to</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,106" id="srcline106">106</a></span><span class="line"><span class="comment">% 1.5 e-12, so the threshold was changed to 1.5e-12 for consistancy</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo" id="T2:U10"><span class="var type1" id="S8T2U23">temp4</span>    =   <span class="mxinfo" id="T2:U12">1.5e-12</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,108" id="srcline108">108</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,109" id="srcline109">109</a></span><span class="line"><span class="comment">%  sgp4fix identify constants and allow alternate values</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,110" id="srcline110">110</a></span><span class="line"><span class="keyword">global</span> <span class="var type2" id="S9T0U26">satrec</span> <span class="var type2" id="S10T0U27">gravc</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,111" id="srcline111">111</a></span><span class="line"><span class="mxinfo" id="T2:U13"><span class="var type1" id="S11T2U30">vkmpersec</span>     = <span class="mxinfo" id="T2:U15"><span class="mxinfo" id="T2:U16"><span class="mxinfo" id="T2:U17"><span class="var type1" id="S10T4U34">gravc</span>.radiusearthkm</span> * <span class="mxinfo" id="T2:U19"><span class="var type1" id="S10T4U37">gravc</span>.xke</span></span>/<span class="mxinfo" id="T2:U21">60.0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,112" id="srcline112">112</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,113" id="srcline113">113</a></span><span class="line"><span class="comment">% Clear sgp4 error flag</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo" id="T2:U22"><span class="mxinfo" id="T2:U23"><span class="var type1" id="S9T1U43">satrec</span>.t</span>     = <span class="var type1" id="S4T2U45">tsince</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo" id="T2:U26"><span class="mxinfo" id="T2:U27"><span class="var type1" id="S9T1U49">satrec</span>.error</span> = <span class="mxinfo" id="T2:U29">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo" id="T2:U30"><span class="var type1" id="S12T2U54">mrt</span> = <span class="mxinfo" id="T2:U32">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,117" id="srcline117">117</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,118" id="srcline118">118</a></span><span class="line"><span class="comment">% Update for secular gravity and atmospheric drag</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T2:U33"><span class="var type1" id="S13T2U58">xmdf</span>    = <span class="mxinfo" id="T2:U35"><span class="mxinfo" id="T2:U36"><span class="var type1" id="S9T1U61">satrec</span>.mo</span> + <span class="mxinfo" id="T2:U38"><span class="mxinfo" id="T2:U39"><span class="var type1" id="S9T1U65">satrec</span>.mdot</span> * <span class="mxinfo" id="T2:U41"><span class="var type1" id="S9T1U68">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,120" id="srcline120">120</a></span><span class="line"><span class="mxinfo" id="T2:U43"><span class="var type1" id="S14T2U72">argpdf</span>  = <span class="mxinfo" id="T2:U45"><span class="mxinfo" id="T2:U46"><span class="var type1" id="S9T1U75">satrec</span>.argpo</span> + <span class="mxinfo" id="T2:U48"><span class="mxinfo" id="T2:U49"><span class="var type1" id="S9T1U79">satrec</span>.argpdot</span> * <span class="mxinfo" id="T2:U51"><span class="var type1" id="S9T1U82">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,121" id="srcline121">121</a></span><span class="line"><span class="mxinfo" id="T2:U53"><span class="var type1" id="S15T2U86">nodedf</span>  = <span class="mxinfo" id="T2:U55"><span class="mxinfo" id="T2:U56"><span class="var type1" id="S9T1U89">satrec</span>.nodeo</span> + <span class="mxinfo" id="T2:U58"><span class="mxinfo" id="T2:U59"><span class="var type1" id="S9T1U93">satrec</span>.nodedot</span> * <span class="mxinfo" id="T2:U61"><span class="var type1" id="S9T1U96">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T2:U63"><span class="var type1" id="S16T2U100">argpm</span>   = <span class="var type1" id="S14T2U101">argpdf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,123" id="srcline123">123</a></span><span class="line"><span class="mxinfo" id="T2:U66"><span class="var type1" id="S17T2U104">mm</span>      = <span class="var type1" id="S13T2U105">xmdf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo" id="T2:U69"><span class="var type1" id="S18T2U108">t2</span>      = <span class="mxinfo" id="T2:U71"><span class="mxinfo" id="T2:U72"><span class="var type1" id="S9T1U111">satrec</span>.t</span> * <span class="mxinfo" id="T2:U74"><span class="var type1" id="S9T1U114">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T2:U76"><span class="var type1" id="S19T2U118">nodem</span>   = <span class="mxinfo" id="T2:U78"><span class="var type1" id="S15T2U120">nodedf</span> + <span class="mxinfo" id="T2:U80"><span class="mxinfo" id="T2:U81"><span class="var type1" id="S9T1U123">satrec</span>.nodecf</span> * <span class="var type1" id="S18T2U125">t2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,126" id="srcline126">126</a></span><span class="line"><span class="mxinfo" id="T2:U84"><span class="var type1" id="S20T2U128">tempa</span>   = <span class="mxinfo" id="T2:U86"><span class="mxinfo" id="T2:U87">1.0</span> - <span class="mxinfo" id="T2:U88"><span class="mxinfo" id="T2:U89"><span class="var type1" id="S9T1U133">satrec</span>.cc1</span> * <span class="mxinfo" id="T2:U91"><span class="var type1" id="S9T1U136">satrec</span>.t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T2:U93"><span class="var type1" id="S21T2U140">tempe</span>   = <span class="mxinfo" id="T2:U95"><span class="mxinfo" id="T2:U96"><span class="mxinfo" id="T2:U97"><span class="var type1" id="S9T1U144">satrec</span>.bstar</span> * <span class="mxinfo" id="T2:U99"><span class="var type1" id="S9T1U147">satrec</span>.cc4</span></span> * <span class="mxinfo" id="T2:U101"><span class="var type1" id="S9T1U150">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T2:U103"><span class="var type1" id="S22T2U154">templ</span>   = <span class="mxinfo" id="T2:U105"><span class="mxinfo" id="T2:U106"><span class="var type1" id="S9T1U157">satrec</span>.t2cof</span> * <span class="var type1" id="S18T2U159">t2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,129" id="srcline129">129</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,130" id="srcline130">130</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U109"><span class="mxinfo" id="T2:U110"><span class="var type1" id="S9T1U165">satrec</span>.isimp</span> ~= <span class="mxinfo" id="T2:U112">1</span></span>) <span class="comment">% Not deep space model</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,131" id="srcline131">131</a></span><span class="line">    <span class="mxinfo" id="T2:U113"><span class="var type1" id="S23T2U170">delomg</span> = <span class="mxinfo" id="T2:U115"><span class="mxinfo" id="T2:U116"><span class="var type1" id="S9T1U173">satrec</span>.omgcof</span> * <span class="mxinfo" id="T2:U118"><span class="var type1" id="S9T1U176">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo" id="T2:U120"><span class="var type1" id="S24T2U180">delm</span>   = <span class="mxinfo" id="T2:U122"><span class="mxinfo" id="T2:U123"><span class="var type1" id="S9T1U183">satrec</span>.xmcof</span> *<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,133" id="srcline133">133</a></span><span class="line"><span class="mxinfo" id="T2:U120"><span class="mxinfo" id="T2:U122">        (<span class="mxinfo" id="T2:U125"><span class="mxinfo" id="T2:U126">(<span class="mxinfo" id="T2:U127"><span class="mxinfo" id="T2:U128">1.0</span> + <span class="mxinfo" id="T2:U129"><span class="mxinfo" id="T2:U130"><span class="var type1" id="S9T1U193">satrec</span>.eta</span> * <span class="mxinfo" id="T2:U132">cos(<span class="var type1" id="S13T2U197">xmdf</span>)</span></span></span>)^3</span> -<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,134" id="srcline134">134</a></span><span class="line"><span class="mxinfo" id="T2:U120"><span class="mxinfo" id="T2:U122"><span class="mxinfo" id="T2:U125">        <span class="mxinfo" id="T2:U134"><span class="var type1" id="S9T1U200">satrec</span>.delmo</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,135" id="srcline135">135</a></span><span class="line">    <span class="mxinfo" id="T2:U136"><span class="var type1" id="S26T2U204">temp</span>   = <span class="mxinfo" id="T2:U138"><span class="var type1" id="S23T2U206">delomg</span> + <span class="var type1" id="S24T2U207">delm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,136" id="srcline136">136</a></span><span class="line">    <span class="mxinfo" id="T2:U141"><span class="var type1" id="S17T2U210">mm</span>     = <span class="mxinfo" id="T2:U143"><span class="var type1" id="S13T2U212">xmdf</span> + <span class="var type1" id="S26T2U213">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo" id="T2:U146"><span class="var type1" id="S16T2U216">argpm</span>  = <span class="mxinfo" id="T2:U148"><span class="var type1" id="S14T2U218">argpdf</span> - <span class="var type1" id="S26T2U219">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,138" id="srcline138">138</a></span><span class="line">    <span class="mxinfo" id="T2:U151"><span class="var type1" id="S27T2U222">t3</span>     = <span class="mxinfo" id="T2:U153"><span class="var type1" id="S18T2U224">t2</span> * <span class="mxinfo" id="T2:U155"><span class="var type1" id="S9T1U226">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo" id="T2:U157"><span class="var type1" id="S28T2U230">t4</span>     = <span class="mxinfo" id="T2:U159"><span class="var type1" id="S27T2U232">t3</span> * <span class="mxinfo" id="T2:U161"><span class="var type1" id="S9T1U234">satrec</span>.t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo" id="T2:U163"><span class="var type1" id="S20T2U238">tempa</span>  = <span class="mxinfo" id="T2:U165"><span class="mxinfo" id="T2:U166"><span class="mxinfo" id="T2:U167"><span class="var type1" id="S20T2U242">tempa</span> - <span class="mxinfo" id="T2:U169"><span class="mxinfo" id="T2:U170"><span class="var type1" id="S9T1U245">satrec</span>.d2</span> * <span class="var type1" id="S18T2U247">t2</span></span></span> - <span class="mxinfo" id="T2:U173"><span class="mxinfo" id="T2:U174"><span class="var type1" id="S9T1U250">satrec</span>.d3</span> * <span class="var type1" id="S27T2U252">t3</span></span></span> -<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,141" id="srcline141">141</a></span><span class="line"><span class="mxinfo" id="T2:U163"><span class="mxinfo" id="T2:U165">        <span class="mxinfo" id="T2:U177"><span class="mxinfo" id="T2:U178"><span class="var type1" id="S9T1U255">satrec</span>.d4</span> * <span class="var type1" id="S28T2U257">t4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo" id="T2:U181"><span class="var type1" id="S21T2U260">tempe</span>  = <span class="mxinfo" id="T2:U183"><span class="var type1" id="S21T2U262">tempe</span> + <span class="mxinfo" id="T2:U185"><span class="mxinfo" id="T2:U186"><span class="mxinfo" id="T2:U187"><span class="var type1" id="S9T1U266">satrec</span>.bstar</span> * <span class="mxinfo" id="T2:U189"><span class="var type1" id="S9T1U269">satrec</span>.cc5</span></span> * (<span class="mxinfo" id="T2:U191"><span class="mxinfo" id="T2:U192">sin(<span class="var type1" id="S17T2U275">mm</span>)</span> -<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo" id="T2:U181"><span class="mxinfo" id="T2:U183"><span class="mxinfo" id="T2:U185"><span class="mxinfo" id="T2:U191">        <span class="mxinfo" id="T2:U194"><span class="var type1" id="S9T1U277">satrec</span>.sinmao</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,144" id="srcline144">144</a></span><span class="line">    <span class="mxinfo" id="T2:U196"><span class="var type1" id="S22T2U281">templ</span>  = <span class="mxinfo" id="T2:U198"><span class="mxinfo" id="T2:U199"><span class="var type1" id="S22T2U284">templ</span> + <span class="mxinfo" id="T2:U201"><span class="mxinfo" id="T2:U202"><span class="var type1" id="S9T1U287">satrec</span>.t3cof</span> * <span class="var type1" id="S27T2U289">t3</span></span></span> + <span class="mxinfo" id="T2:U205"><span class="var type1" id="S28T2U291">t4</span> * (<span class="mxinfo" id="T2:U207"><span class="mxinfo" id="T2:U208"><span class="var type1" id="S9T1U295">satrec</span>.t4cof</span> +<span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,145" id="srcline145">145</a></span><span class="line"><span class="mxinfo" id="T2:U196"><span class="mxinfo" id="T2:U198"><span class="mxinfo" id="T2:U205"><span class="mxinfo" id="T2:U207">        <span class="mxinfo" id="T2:U210"><span class="mxinfo" id="T2:U211"><span class="var type1" id="S9T1U299">satrec</span>.t</span> * <span class="mxinfo" id="T2:U213"><span class="var type1" id="S9T1U302">satrec</span>.t5cof</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,146" id="srcline146">146</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo" id="T2:U215"><span class="var type1" id="S30T2U306">nm</span>    = <span class="mxinfo" id="T2:U217"><span class="var type1" id="S9T1U308">satrec</span>.no</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,149" id="srcline149">149</a></span><span class="line"><span class="mxinfo" id="T2:U219"><span class="var type1" id="S31T2U312">em</span>    = <span class="mxinfo" id="T2:U221"><span class="var type1" id="S9T1U314">satrec</span>.ecco</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,150" id="srcline150">150</a></span><span class="line"><span class="mxinfo" id="T2:U223"><span class="var type1" id="S32T2U318">inclm</span> = <span class="mxinfo" id="T2:U225"><span class="var type1" id="S9T1U320">satrec</span>.inclo</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,151" id="srcline151">151</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,152" id="srcline152">152</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U227"><span class="var type1" id="S30T2U326">nm</span> &lt;= <span class="mxinfo" id="T2:U229">0.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="47,153" id="srcline153">153</a></span><span class="line">    <span class="mxinfo" id="T2:U230"><span class="mxinfo" id="T2:U231"><span class="var type1" id="S9T1U331">satrec</span>.error</span> = <span class="mxinfo" id="T2:U233">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,154" id="srcline154">154</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T2:U234"><span class="var type1" id="S33T2U336">am</span> = <span class="mxinfo" id="T2:U236"><span class="mxinfo" id="T2:U237"><span class="mxinfo" id="T2:U238">(<span class="mxinfo" id="T2:U239"><span class="mxinfo" id="T2:U240"><span class="var type1" id="S10T4U343">gravc</span>.xke</span> / <span class="var type1" id="S30T2U345">nm</span></span>)^<span class="var type1" id="S7T2U346">x2o3</span></span> * <span class="var type1" id="S20T2U347">tempa</span></span> * <span class="var type1" id="S20T2U348">tempa</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T2:U246"><span class="var type1" id="S30T2U351">nm</span> = <span class="mxinfo" id="T2:U248"><span class="mxinfo" id="T2:U249"><span class="var type1" id="S10T4U354">gravc</span>.xke</span> / <span class="mxinfo" id="T2:U251"><span class="var type1" id="S33T2U357">am</span>^1.5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo" id="T2:U253"><span class="var type1" id="S31T2U361">em</span> = <span class="mxinfo" id="T2:U255"><span class="var type1" id="S31T2U363">em</span> - <span class="var type1" id="S21T2U364">tempe</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,159" id="srcline159">159</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,160" id="srcline160">160</a></span><span class="line"><span class="comment">% fix tolerance for error recognition</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,161" id="srcline161">161</a></span><span class="line"><span class="keyword">if</span> ((<span class="mxinfo" id="T5:U258"><span class="var type1" id="S31T2U372">em</span> &gt;= <span class="mxinfo" id="T2:U260">1.0</span></span>) || (<span class="mxinfo" id="T5:U261"><span class="var type1" id="S31T2U376">em</span> &lt; <span class="mxinfo" id="T2:U263">-<span class="mxinfo" id="T2:U264">0.001</span></span></span>) || (<span class="mxinfo" id="T5:U265"><span class="var type1" id="S33T2U381">am</span> &lt; <span class="mxinfo" id="T2:U267">0.95</span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="47,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo" id="T2:U268"><span class="mxinfo" id="T2:U269"><span class="var type1" id="S9T1U386">satrec</span>.error</span> = <span class="mxinfo" id="T2:U271">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,163" id="srcline163">163</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,164" id="srcline164">164</a></span><span class="line"><span class="comment">%   sgp4fix change test condition for eccentricity</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,165" id="srcline165">165</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U272"><span class="var type1" id="S31T2U393">em</span> &lt; <span class="mxinfo" id="T2:U274">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="47,166" id="srcline166">166</a></span><span class="line">    <span class="mxinfo" id="T2:U275"><span class="var type1" id="S31T2U397">em</span>  = <span class="mxinfo" id="T2:U277">1.0e-6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,167" id="srcline167">167</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo" id="T2:U278"><span class="var type1" id="S17T2U401">mm</span>     = <span class="mxinfo" id="T2:U280"><span class="var type1" id="S17T2U403">mm</span> + <span class="mxinfo" id="T2:U282"><span class="mxinfo" id="T2:U283"><span class="var type1" id="S9T1U406">satrec</span>.no</span> * <span class="var type1" id="S22T2U408">templ</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo" id="T2:U286"><span class="var type1" id="S34T2U411">xlm</span>    = <span class="mxinfo" id="T2:U288"><span class="mxinfo" id="T2:U289"><span class="var type1" id="S17T2U414">mm</span> + <span class="var type1" id="S16T2U415">argpm</span></span> + <span class="var type1" id="S19T2U416">nodem</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo" id="T2:U293"><span class="var type1" id="S35T2U419">emsq</span>   = <span class="mxinfo" id="T2:U295"><span class="var type1" id="S31T2U421">em</span> * <span class="var type1" id="S31T2U422">em</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo" id="T2:U298"><span class="var type1" id="S26T2U425">temp</span>   = <span class="mxinfo" id="T2:U300"><span class="mxinfo" id="T2:U301">1.0</span> - <span class="var type1" id="S35T2U428">emsq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo" id="T2:U303"><span class="var type1" id="S19T2U431">nodem</span>  = <span class="mxinfo" id="T2:U305">rem(<span class="var type1" id="S19T2U434">nodem</span>, <span class="mxinfo" id="T2:U307"><span class="var type1" id="S5T2U435">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T2:U309"><span class="var type1" id="S16T2U438">argpm</span>  = <span class="mxinfo" id="T2:U311">rem(<span class="var type1" id="S16T2U441">argpm</span>, <span class="mxinfo" id="T2:U313"><span class="var type1" id="S5T2U442">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T2:U315"><span class="var type1" id="S34T2U445">xlm</span>    = <span class="mxinfo" id="T2:U317">rem(<span class="var type1" id="S34T2U448">xlm</span>, <span class="mxinfo" id="T2:U319"><span class="var type1" id="S5T2U449">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,175" id="srcline175">175</a></span><span class="line"><span class="mxinfo" id="T2:U321"><span class="var type1" id="S17T2U452">mm</span>     = <span class="mxinfo" id="T2:U323">rem(<span class="mxinfo" id="T2:U324"><span class="mxinfo" id="T2:U325"><span class="var type1" id="S34T2U457">xlm</span> - <span class="var type1" id="S16T2U458">argpm</span></span> - <span class="var type1" id="S19T2U459">nodem</span></span>, <span class="mxinfo" id="T2:U329"><span class="var type1" id="S5T2U460">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,176" id="srcline176">176</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,177" id="srcline177">177</a></span><span class="line"><span class="comment">% compute extra mean quantities</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,178" id="srcline178">178</a></span><span class="line"><span class="mxinfo" id="T2:U331"><span class="var type1" id="S37T2U463">sinim</span> = <span class="mxinfo" id="T2:U333">sin(<span class="var type1" id="S32T2U466">inclm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,179" id="srcline179">179</a></span><span class="line"><span class="mxinfo" id="T2:U335"><span class="var type1" id="S38T2U469">cosim</span> = <span class="mxinfo" id="T2:U337">cos(<span class="var type1" id="S32T2U472">inclm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,180" id="srcline180">180</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,181" id="srcline181">181</a></span><span class="line"><span class="comment">% add lunar-solar periodics</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,182" id="srcline182">182</a></span><span class="line"><span class="mxinfo" id="T2:U339"><span class="var type1" id="S39T2U475">ep</span>     = <span class="var type1" id="S31T2U476">em</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo" id="T2:U342"><span class="var type1" id="S40T2U479">xincp</span>  = <span class="var type1" id="S32T2U480">inclm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,184" id="srcline184">184</a></span><span class="line"><span class="mxinfo" id="T2:U345"><span class="var type1" id="S41T2U483">argpp</span>  = <span class="var type1" id="S16T2U484">argpm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo" id="T2:U348"><span class="var type1" id="S42T2U487">nodep</span>  = <span class="var type1" id="S19T2U488">nodem</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,186" id="srcline186">186</a></span><span class="line"><span class="mxinfo" id="T2:U351"><span class="var type1" id="S43T2U491">mp</span>     = <span class="var type1" id="S17T2U492">mm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo" id="T2:U354"><span class="var type1" id="S44T2U495">sinip</span>  = <span class="var type1" id="S37T2U496">sinim</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T2:U357"><span class="var type1" id="S45T2U499">cosip</span>  = <span class="var type1" id="S38T2U500">cosim</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,189" id="srcline189">189</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,190" id="srcline190">190</a></span><span class="line"><span class="comment">% long period periodics</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo" id="T2:U360"><span class="var type1" id="S46T2U503">axnl</span> = <span class="mxinfo" id="T2:U362"><span class="var type1" id="S39T2U505">ep</span> * <span class="mxinfo" id="T2:U364">cos(<span class="var type1" id="S41T2U508">argpp</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo" id="T2:U366"><span class="var type1" id="S26T2U511">temp</span> = <span class="mxinfo" id="T2:U368"><span class="mxinfo" id="T2:U369">1.0</span> / (<span class="mxinfo" id="T2:U370"><span class="var type1" id="S33T2U516">am</span> * (<span class="mxinfo" id="T2:U372"><span class="mxinfo" id="T2:U373">1.0</span> - <span class="mxinfo" id="T2:U374"><span class="var type1" id="S39T2U521">ep</span> * <span class="var type1" id="S39T2U522">ep</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,193" id="srcline193">193</a></span><span class="line"><span class="mxinfo" id="T2:U377"><span class="var type1" id="S47T2U525">aynl</span> = <span class="mxinfo" id="T2:U379"><span class="mxinfo" id="T2:U380"><span class="var type1" id="S39T2U528">ep</span>* <span class="mxinfo" id="T2:U382">sin(<span class="var type1" id="S41T2U531">argpp</span>)</span></span> + <span class="mxinfo" id="T2:U384"><span class="var type1" id="S26T2U533">temp</span> * <span class="mxinfo" id="T2:U386"><span class="var type1" id="S9T1U535">satrec</span>.aycof</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,194" id="srcline194">194</a></span><span class="line"><span class="mxinfo" id="T2:U388"><span class="var type1" id="S48T2U539">xl</span>   = <span class="mxinfo" id="T2:U390"><span class="mxinfo" id="T2:U391"><span class="mxinfo" id="T2:U392"><span class="var type1" id="S43T2U543">mp</span> + <span class="var type1" id="S41T2U544">argpp</span></span> + <span class="var type1" id="S42T2U545">nodep</span></span> + <span class="mxinfo" id="T2:U396"><span class="mxinfo" id="T2:U397"><span class="var type1" id="S26T2U548">temp</span> * <span class="mxinfo" id="T2:U399"><span class="var type1" id="S9T1U550">satrec</span>.xlcof</span></span> * <span class="var type1" id="S46T2U552">axnl</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,195" id="srcline195">195</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,196" id="srcline196">196</a></span><span class="line"><span class="comment">% solve kepler's equation</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,197" id="srcline197">197</a></span><span class="line"><span class="mxinfo" id="T2:U402"><span class="var type1" id="S49T2U555">u</span>    = <span class="mxinfo" id="T2:U404">rem(<span class="mxinfo" id="T2:U405"><span class="var type1" id="S48T2U559">xl</span> - <span class="var type1" id="S42T2U560">nodep</span></span>, <span class="mxinfo" id="T2:U408"><span class="var type1" id="S5T2U561">twopi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,198" id="srcline198">198</a></span><span class="line"><span class="mxinfo" id="T2:U410"><span class="var type1" id="S50T2U564">eo1</span>  = <span class="var type1" id="S49T2U565">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,199" id="srcline199">199</a></span><span class="line"><span class="mxinfo" id="T2:U413"><span class="var type1" id="S51T2U568">tem5</span> = <span class="mxinfo" id="T2:U415">9999.9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,200" id="srcline200">200</a></span><span class="line"><span class="mxinfo" id="T2:U416"><span class="var type1" id="S52T2U572">ktr</span> = <span class="mxinfo" id="T2:U418">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,201" id="srcline201">201</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,202" id="srcline202">202</a></span><span class="line"><span class="comment">% sgp4fix for kepler iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,203" id="srcline203">203</a></span><span class="line"><span class="comment">% the following iteration needs better limits on corrections</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,204" id="srcline204">204</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,205" id="srcline205">205</a></span><span class="line"><span class="comment">% To please the compiler, the following variable are defined here so that</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,206" id="srcline206">206</a></span><span class="line"><span class="comment">% they are not undefined for some execution paths.</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,207" id="srcline207">207</a></span><span class="line"><span class="mxinfo" id="T2:U419"><span class="var type1" id="S53T2U576">sineo1</span> = <span class="mxinfo" id="T2:U421">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,208" id="srcline208">208</a></span><span class="line"><span class="mxinfo" id="T2:U422"><span class="var type1" id="S54T2U580">coseo1</span> = <span class="mxinfo" id="T2:U424">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,209" id="srcline209">209</a></span><span class="line"><span class="keyword">while</span> (( <span class="mxinfo" id="T5:U425"><span class="mxinfo" id="T2:U426">abs(<span class="var type1" id="S51T2U589">tem5</span>)</span> &gt;= <span class="mxinfo" id="T2:U428">1.0e-12</span></span>) &amp;&amp; (<span class="mxinfo" id="T5:U429"><span class="var type1" id="S52T2U593">ktr</span> &lt;= <span class="mxinfo" id="T2:U431">10</span></span>) )</span></span>
<span class="srcline"><span class="lineno"><a href="47,210" id="srcline210">210</a></span><span class="line">    <span class="mxinfo" id="T2:U432"><span class="var type1" id="S53T2U597">sineo1</span> = <span class="mxinfo" id="T2:U434">sin(<span class="var type1" id="S50T2U600">eo1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,211" id="srcline211">211</a></span><span class="line">    <span class="mxinfo" id="T2:U436"><span class="var type1" id="S54T2U603">coseo1</span> = <span class="mxinfo" id="T2:U438">cos(<span class="var type1" id="S50T2U606">eo1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,212" id="srcline212">212</a></span><span class="line">    <span class="mxinfo" id="T2:U440"><span class="var type1" id="S51T2U609">tem5</span>   = <span class="mxinfo" id="T2:U442"><span class="mxinfo" id="T2:U443"><span class="mxinfo" id="T2:U444">1.0</span> - <span class="mxinfo" id="T2:U445"><span class="var type1" id="S54T2U614">coseo1</span> * <span class="var type1" id="S46T2U615">axnl</span></span></span> - <span class="mxinfo" id="T2:U448"><span class="var type1" id="S53T2U617">sineo1</span> * <span class="var type1" id="S47T2U618">aynl</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,213" id="srcline213">213</a></span><span class="line">    <span class="mxinfo" id="T2:U451"><span class="var type1" id="S51T2U621">tem5</span>   = <span class="mxinfo" id="T2:U453">(<span class="mxinfo" id="T2:U454"><span class="mxinfo" id="T2:U455"><span class="mxinfo" id="T2:U456"><span class="var type1" id="S49T2U627">u</span> - <span class="mxinfo" id="T2:U458"><span class="var type1" id="S47T2U629">aynl</span> * <span class="var type1" id="S54T2U630">coseo1</span></span></span> + <span class="mxinfo" id="T2:U461"><span class="var type1" id="S46T2U632">axnl</span> * <span class="var type1" id="S53T2U633">sineo1</span></span></span> - <span class="var type1" id="S50T2U634">eo1</span></span>) / <span class="var type1" id="S51T2U635">tem5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,214" id="srcline214">214</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo" id="T5:U466"><span class="mxinfo" id="T2:U467">abs(<span class="var type1" id="S51T2U642">tem5</span>)</span> &gt;= <span class="mxinfo" id="T2:U469">0.95</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="47,215" id="srcline215">215</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T5:U470"><span class="var type1" id="S51T2U647">tem5</span> &gt; <span class="mxinfo" id="T2:U472">0.0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,216" id="srcline216">216</a></span><span class="line">            <span class="mxinfo" id="T2:U473"><span class="var type1" id="S51T2U651">tem5</span> = <span class="mxinfo" id="T2:U475">0.95</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,217" id="srcline217">217</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,218" id="srcline218">218</a></span><span class="line">            <span class="mxinfo" id="T2:U476"><span class="var type1" id="S51T2U656">tem5</span> = <span class="mxinfo" id="T2:U478">-<span class="mxinfo" id="T2:U479">0.95</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,219" id="srcline219">219</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,220" id="srcline220">220</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,221" id="srcline221">221</a></span><span class="line">    <span class="mxinfo" id="T2:U480"><span class="var type1" id="S50T2U661">eo1</span>    = <span class="mxinfo" id="T2:U482"><span class="var type1" id="S50T2U663">eo1</span> + <span class="var type1" id="S51T2U664">tem5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,222" id="srcline222">222</a></span><span class="line">    <span class="mxinfo" id="T2:U485"><span class="var type1" id="S52T2U667">ktr</span> = <span class="mxinfo" id="T2:U487"><span class="var type1" id="S52T2U669">ktr</span> + <span class="mxinfo" id="T2:U489">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,223" id="srcline223">223</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,224" id="srcline224">224</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,225" id="srcline225">225</a></span><span class="line"><span class="comment">% Short period preliminary quantities</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,226" id="srcline226">226</a></span><span class="line"><span class="mxinfo" id="T2:U490"><span class="var type1" id="S56T2U673">ecose</span> = <span class="mxinfo" id="T2:U492"><span class="mxinfo" id="T2:U493"><span class="var type1" id="S46T2U676">axnl</span>*<span class="var type1" id="S54T2U677">coseo1</span></span> + <span class="mxinfo" id="T2:U496"><span class="var type1" id="S47T2U679">aynl</span>*<span class="var type1" id="S53T2U680">sineo1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,227" id="srcline227">227</a></span><span class="line"><span class="mxinfo" id="T2:U499"><span class="var type1" id="S57T2U683">esine</span> = <span class="mxinfo" id="T2:U501"><span class="mxinfo" id="T2:U502"><span class="var type1" id="S46T2U686">axnl</span>*<span class="var type1" id="S53T2U687">sineo1</span></span> - <span class="mxinfo" id="T2:U505"><span class="var type1" id="S47T2U689">aynl</span>*<span class="var type1" id="S54T2U690">coseo1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,228" id="srcline228">228</a></span><span class="line"><span class="mxinfo" id="T2:U508"><span class="var type1" id="S58T2U693">el2</span>   = <span class="mxinfo" id="T2:U510"><span class="mxinfo" id="T2:U511"><span class="var type1" id="S46T2U696">axnl</span>*<span class="var type1" id="S46T2U697">axnl</span></span> + <span class="mxinfo" id="T2:U514"><span class="var type1" id="S47T2U699">aynl</span>*<span class="var type1" id="S47T2U700">aynl</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,229" id="srcline229">229</a></span><span class="line"><span class="mxinfo" id="T2:U517"><span class="var type1" id="S59T2U703">pl</span>    = <span class="mxinfo" id="T2:U519"><span class="var type1" id="S33T2U705">am</span>*(<span class="mxinfo" id="T2:U521"><span class="mxinfo" id="T2:U522">1.0</span>-<span class="var type1" id="S58T2U709">el2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,230" id="srcline230">230</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U524"><span class="var type1" id="S59T2U714">pl</span> &lt; <span class="mxinfo" id="T2:U526">0.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="47,231" id="srcline231">231</a></span><span class="line">    <span class="mxinfo" id="T2:U527"><span class="mxinfo" id="T2:U528"><span class="var type1" id="S9T1U719">satrec</span>.error</span> = <span class="mxinfo" id="T2:U530">4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,232" id="srcline232">232</a></span><span class="line">    <span class="mxinfo" id="T22:U531"><span class="var type1" id="S2T22U724">r</span> = <span class="mxinfo" id="T22:U533">[<span class="mxinfo" id="T2:U534">0</span>;<span class="mxinfo" id="T2:U535">0</span>;<span class="mxinfo" id="T2:U536">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,233" id="srcline233">233</a></span><span class="line">    <span class="mxinfo" id="T22:U537"><span class="var type1" id="S3T22U734">v</span> = <span class="mxinfo" id="T22:U539">[<span class="mxinfo" id="T2:U540">0</span>;<span class="mxinfo" id="T2:U541">0</span>;<span class="mxinfo" id="T2:U542">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,234" id="srcline234">234</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,235" id="srcline235">235</a></span><span class="line">    <span class="mxinfo" id="T2:U543"><span class="var type1" id="S60T2U745">rl</span>     = <span class="mxinfo" id="T2:U545"><span class="var type1" id="S33T2U747">am</span> * (<span class="mxinfo" id="T2:U547"><span class="mxinfo" id="T2:U548">1.0</span> - <span class="var type1" id="S56T2U751">ecose</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,236" id="srcline236">236</a></span><span class="line">    <span class="mxinfo" id="T2:U550"><span class="var type1" id="S61T2U754">rdotl</span>  = <span class="mxinfo" id="T2:U552"><span class="mxinfo" id="T2:U553"><span class="mxinfo" id="T2:U554">sqrt(<span class="var type1" id="S33T2U759">am</span>)</span> * <span class="var type1" id="S57T2U760">esine</span></span>/<span class="var type1" id="S60T2U761">rl</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,237" id="srcline237">237</a></span><span class="line">    <span class="mxinfo" id="T2:U558"><span class="var type1" id="S63T2U764">rvdotl</span> = <span class="mxinfo" id="T2:U560"><span class="mxinfo" id="T2:U561">sqrt(<span class="var type1" id="S59T2U768">pl</span>)</span> / <span class="var type1" id="S60T2U769">rl</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,238" id="srcline238">238</a></span><span class="line">    <span class="mxinfo" id="T2:U564"><span class="var type1" id="S64T2U772">betal</span>  = <span class="mxinfo" id="T2:U566">sqrt(<span class="mxinfo" id="T2:U567"><span class="mxinfo" id="T2:U568">1.0</span> - <span class="var type1" id="S58T2U777">el2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,239" id="srcline239">239</a></span><span class="line">    <span class="mxinfo" id="T2:U570"><span class="var type1" id="S26T2U780">temp</span>   = <span class="mxinfo" id="T2:U572"><span class="var type1" id="S57T2U782">esine</span> / (<span class="mxinfo" id="T2:U574"><span class="mxinfo" id="T2:U575">1.0</span> + <span class="var type1" id="S64T2U786">betal</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,240" id="srcline240">240</a></span><span class="line">    <span class="mxinfo" id="T2:U577"><span class="var type1" id="S65T2U789">sinu</span>   = <span class="mxinfo" id="T2:U579"><span class="mxinfo" id="T2:U580"><span class="var type1" id="S33T2U792">am</span> / <span class="var type1" id="S60T2U793">rl</span></span> * (<span class="mxinfo" id="T2:U583"><span class="mxinfo" id="T2:U584"><span class="var type1" id="S53T2U797">sineo1</span> - <span class="var type1" id="S47T2U798">aynl</span></span> - <span class="mxinfo" id="T2:U587"><span class="var type1" id="S46T2U800">axnl</span> * <span class="var type1" id="S26T2U801">temp</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,241" id="srcline241">241</a></span><span class="line">    <span class="mxinfo" id="T2:U590"><span class="var type1" id="S66T2U804">cosu</span>   = <span class="mxinfo" id="T2:U592"><span class="mxinfo" id="T2:U593"><span class="var type1" id="S33T2U807">am</span> / <span class="var type1" id="S60T2U808">rl</span></span> * (<span class="mxinfo" id="T2:U596"><span class="mxinfo" id="T2:U597"><span class="var type1" id="S54T2U812">coseo1</span> - <span class="var type1" id="S46T2U813">axnl</span></span> + <span class="mxinfo" id="T2:U600"><span class="var type1" id="S47T2U815">aynl</span> * <span class="var type1" id="S26T2U816">temp</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,242" id="srcline242">242</a></span><span class="line">    <span class="mxinfo" id="T2:U603"><span class="var type1" id="S67T2U819">su</span>     = <span class="mxinfo" id="T2:U605">atan2(<span class="var type1" id="S65T2U822">sinu</span>, <span class="var type1" id="S66T2U823">cosu</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,243" id="srcline243">243</a></span><span class="line">    <span class="mxinfo" id="T2:U608"><span class="var type1" id="S69T2U826">sin2u</span>  = <span class="mxinfo" id="T2:U610">(<span class="mxinfo" id="T2:U611"><span class="var type1" id="S66T2U830">cosu</span> + <span class="var type1" id="S66T2U831">cosu</span></span>) * <span class="var type1" id="S65T2U832">sinu</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,244" id="srcline244">244</a></span><span class="line">    <span class="mxinfo" id="T2:U615"><span class="var type1" id="S70T2U835">cos2u</span>  = <span class="mxinfo" id="T2:U617"><span class="mxinfo" id="T2:U618">1.0</span> - <span class="mxinfo" id="T2:U619"><span class="mxinfo" id="T2:U620"><span class="mxinfo" id="T2:U621">2.0</span> * <span class="var type1" id="S65T2U841">sinu</span></span> * <span class="var type1" id="S65T2U842">sinu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,245" id="srcline245">245</a></span><span class="line">    <span class="mxinfo" id="T2:U624"><span class="var type1" id="S26T2U845">temp</span>   = <span class="mxinfo" id="T2:U626"><span class="mxinfo" id="T2:U627">1.0</span> / <span class="var type1" id="S59T2U848">pl</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,246" id="srcline246">246</a></span><span class="line">    <span class="mxinfo" id="T2:U629"><span class="var type1" id="S71T2U851">temp1</span>  = <span class="mxinfo" id="T2:U631"><span class="mxinfo" id="T2:U632"><span class="mxinfo" id="T2:U633">0.5</span> * <span class="mxinfo" id="T2:U634"><span class="var type1" id="S10T4U856">gravc</span>.j2</span></span> * <span class="var type1" id="S26T2U858">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,247" id="srcline247">247</a></span><span class="line">    <span class="mxinfo" id="T2:U637"><span class="var type1" id="S72T2U861">temp2</span>  = <span class="mxinfo" id="T2:U639"><span class="var type1" id="S71T2U863">temp1</span> * <span class="var type1" id="S26T2U864">temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,248" id="srcline248">248</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="47,249" id="srcline249">249</a></span><span class="line">    <span class="comment">% update for short period periodics</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,250" id="srcline250">250</a></span><span class="line">    <span class="mxinfo" id="T2:U642"><span class="var type1" id="S12T2U867">mrt</span>   = <span class="mxinfo" id="T2:U644"><span class="mxinfo" id="T2:U645"><span class="var type1" id="S60T2U870">rl</span> * (<span class="mxinfo" id="T2:U647"><span class="mxinfo" id="T2:U648">1.0</span> - <span class="mxinfo" id="T2:U649"><span class="mxinfo" id="T2:U650"><span class="mxinfo" id="T2:U651"><span class="mxinfo" id="T2:U652">1.5</span> * <span class="var type1" id="S72T2U878">temp2</span></span> * <span class="var type1" id="S64T2U879">betal</span></span> * <span class="mxinfo" id="T2:U655"><span class="var type1" id="S9T1U881">satrec</span>.con41</span></span></span>)</span> +<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,251" id="srcline251">251</a></span><span class="line"><span class="mxinfo" id="T2:U642"><span class="mxinfo" id="T2:U644">        <span class="mxinfo" id="T2:U657"><span class="mxinfo" id="T2:U658"><span class="mxinfo" id="T2:U659"><span class="mxinfo" id="T2:U660">0.5</span> * <span class="var type1" id="S71T2U887">temp1</span></span> * <span class="mxinfo" id="T2:U662"><span class="var type1" id="S9T1U889">satrec</span>.x1mth2</span></span> * <span class="var type1" id="S70T2U891">cos2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,252" id="srcline252">252</a></span><span class="line">    <span class="mxinfo" id="T2:U665"><span class="var type1" id="S67T2U894">su</span>    = <span class="mxinfo" id="T2:U667"><span class="var type1" id="S67T2U896">su</span> - <span class="mxinfo" id="T2:U669"><span class="mxinfo" id="T2:U670"><span class="mxinfo" id="T2:U671"><span class="mxinfo" id="T2:U672">0.25</span> * <span class="var type1" id="S72T2U901">temp2</span></span> * <span class="mxinfo" id="T2:U674"><span class="var type1" id="S9T1U903">satrec</span>.x7thm1</span></span> * <span class="var type1" id="S69T2U905">sin2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,253" id="srcline253">253</a></span><span class="line">    <span class="mxinfo" id="T2:U677"><span class="var type1" id="S73T2U908">xnode</span> = <span class="mxinfo" id="T2:U679"><span class="var type1" id="S42T2U910">nodep</span> + <span class="mxinfo" id="T2:U681"><span class="mxinfo" id="T2:U682"><span class="mxinfo" id="T2:U683"><span class="mxinfo" id="T2:U684">1.5</span> * <span class="var type1" id="S72T2U915">temp2</span></span> * <span class="var type1" id="S45T2U916">cosip</span></span> * <span class="var type1" id="S69T2U917">sin2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,254" id="srcline254">254</a></span><span class="line">    <span class="mxinfo" id="T2:U688"><span class="var type1" id="S74T2U920">xinc</span>  = <span class="mxinfo" id="T2:U690"><span class="var type1" id="S40T2U922">xincp</span> + <span class="mxinfo" id="T2:U692"><span class="mxinfo" id="T2:U693"><span class="mxinfo" id="T2:U694"><span class="mxinfo" id="T2:U695"><span class="mxinfo" id="T2:U696">1.5</span> * <span class="var type1" id="S72T2U928">temp2</span></span> * <span class="var type1" id="S45T2U929">cosip</span></span> * <span class="var type1" id="S44T2U930">sinip</span></span> * <span class="var type1" id="S70T2U931">cos2u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,255" id="srcline255">255</a></span><span class="line">    <span class="mxinfo" id="T2:U701"><span class="var type1" id="S75T2U934">mvt</span>   = <span class="mxinfo" id="T2:U703"><span class="var type1" id="S61T2U936">rdotl</span> - <span class="mxinfo" id="T2:U705"><span class="mxinfo" id="T2:U706"><span class="mxinfo" id="T2:U707"><span class="mxinfo" id="T2:U708"><span class="var type1" id="S30T2U941">nm</span> * <span class="var type1" id="S71T2U942">temp1</span></span> * <span class="mxinfo" id="T2:U711"><span class="var type1" id="S9T1U944">satrec</span>.x1mth2</span></span> * <span class="var type1" id="S69T2U946">sin2u</span></span> / <span class="mxinfo" id="T2:U714"><span class="var type1" id="S10T4U948">gravc</span>.xke</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,256" id="srcline256">256</a></span><span class="line">    <span class="mxinfo" id="T2:U716"><span class="var type1" id="S76T2U952">rvdot</span> = <span class="mxinfo" id="T2:U718"><span class="var type1" id="S63T2U954">rvdotl</span> + <span class="mxinfo" id="T2:U720"><span class="mxinfo" id="T2:U721"><span class="mxinfo" id="T2:U722"><span class="var type1" id="S30T2U958">nm</span> * <span class="var type1" id="S71T2U959">temp1</span></span> * (<span class="mxinfo" id="T2:U725"><span class="mxinfo" id="T2:U726"><span class="mxinfo" id="T2:U727"><span class="var type1" id="S9T1U964">satrec</span>.x1mth2</span> * <span class="var type1" id="S70T2U966">cos2u</span></span> +<span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,257" id="srcline257">257</a></span><span class="line"><span class="mxinfo" id="T2:U716"><span class="mxinfo" id="T2:U718"><span class="mxinfo" id="T2:U720"><span class="mxinfo" id="T2:U721"><span class="mxinfo" id="T2:U725">        <span class="mxinfo" id="T2:U730"><span class="mxinfo" id="T2:U731">1.5</span> * <span class="mxinfo" id="T2:U732"><span class="var type1" id="S9T1U970">satrec</span>.con41</span></span></span>)</span> / <span class="mxinfo" id="T2:U734"><span class="var type1" id="S10T4U973">gravc</span>.xke</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,258" id="srcline258">258</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="47,259" id="srcline259">259</a></span><span class="line">    <span class="comment">% orientation vectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,260" id="srcline260">260</a></span><span class="line">    <span class="mxinfo" id="T2:U736"><span class="var type1" id="S77T2U977">sinsu</span> =  <span class="mxinfo" id="T2:U738">sin(<span class="var type1" id="S67T2U980">su</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,261" id="srcline261">261</a></span><span class="line">    <span class="mxinfo" id="T2:U740"><span class="var type1" id="S78T2U983">cossu</span> =  <span class="mxinfo" id="T2:U742">cos(<span class="var type1" id="S67T2U986">su</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,262" id="srcline262">262</a></span><span class="line">    <span class="mxinfo" id="T2:U744"><span class="var type1" id="S79T2U989">snod</span>  =  <span class="mxinfo" id="T2:U746">sin(<span class="var type1" id="S73T2U992">xnode</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,263" id="srcline263">263</a></span><span class="line">    <span class="mxinfo" id="T2:U748"><span class="var type1" id="S80T2U995">cnod</span>  =  <span class="mxinfo" id="T2:U750">cos(<span class="var type1" id="S73T2U998">xnode</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,264" id="srcline264">264</a></span><span class="line">    <span class="mxinfo" id="T2:U752"><span class="var type1" id="S81T2U1001">sini</span>  =  <span class="mxinfo" id="T2:U754">sin(<span class="var type1" id="S74T2U1004">xinc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,265" id="srcline265">265</a></span><span class="line">    <span class="mxinfo" id="T2:U756"><span class="var type1" id="S82T2U1007">cosi</span>  =  <span class="mxinfo" id="T2:U758">cos(<span class="var type1" id="S74T2U1010">xinc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,266" id="srcline266">266</a></span><span class="line">    <span class="mxinfo" id="T2:U760"><span class="var type1" id="S83T2U1013">xmx</span>   = <span class="mxinfo" id="T2:U762"><span class="mxinfo" id="T2:U763">-<span class="var type1" id="S79T2U1016">snod</span></span> * <span class="var type1" id="S82T2U1017">cosi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,267" id="srcline267">267</a></span><span class="line">    <span class="mxinfo" id="T2:U766"><span class="var type1" id="S84T2U1020">xmy</span>   =  <span class="mxinfo" id="T2:U768"><span class="var type1" id="S80T2U1022">cnod</span> * <span class="var type1" id="S82T2U1023">cosi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,268" id="srcline268">268</a></span><span class="line">    <span class="mxinfo" id="T2:U771"><span class="var type1" id="S85T2U1026">ux</span>    =  <span class="mxinfo" id="T2:U773"><span class="mxinfo" id="T2:U774"><span class="var type1" id="S83T2U1029">xmx</span> * <span class="var type1" id="S77T2U1030">sinsu</span></span> + <span class="mxinfo" id="T2:U777"><span class="var type1" id="S80T2U1032">cnod</span> * <span class="var type1" id="S78T2U1033">cossu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,269" id="srcline269">269</a></span><span class="line">    <span class="mxinfo" id="T2:U780"><span class="var type1" id="S86T2U1036">uy</span>    =  <span class="mxinfo" id="T2:U782"><span class="mxinfo" id="T2:U783"><span class="var type1" id="S84T2U1039">xmy</span> * <span class="var type1" id="S77T2U1040">sinsu</span></span> + <span class="mxinfo" id="T2:U786"><span class="var type1" id="S79T2U1042">snod</span> * <span class="var type1" id="S78T2U1043">cossu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,270" id="srcline270">270</a></span><span class="line">    <span class="mxinfo" id="T2:U789"><span class="var type1" id="S87T2U1046">uz</span>    =  <span class="mxinfo" id="T2:U791"><span class="var type1" id="S81T2U1048">sini</span> * <span class="var type1" id="S77T2U1049">sinsu</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,271" id="srcline271">271</a></span><span class="line">    <span class="mxinfo" id="T2:U794"><span class="var type1" id="S88T2U1052">vx</span>    =  <span class="mxinfo" id="T2:U796"><span class="mxinfo" id="T2:U797"><span class="var type1" id="S83T2U1055">xmx</span> * <span class="var type1" id="S78T2U1056">cossu</span></span> - <span class="mxinfo" id="T2:U800"><span class="var type1" id="S80T2U1058">cnod</span> * <span class="var type1" id="S77T2U1059">sinsu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,272" id="srcline272">272</a></span><span class="line">    <span class="mxinfo" id="T2:U803"><span class="var type1" id="S89T2U1062">vy</span>    =  <span class="mxinfo" id="T2:U805"><span class="mxinfo" id="T2:U806"><span class="var type1" id="S84T2U1065">xmy</span> * <span class="var type1" id="S78T2U1066">cossu</span></span> - <span class="mxinfo" id="T2:U809"><span class="var type1" id="S79T2U1068">snod</span> * <span class="var type1" id="S77T2U1069">sinsu</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,273" id="srcline273">273</a></span><span class="line">    <span class="mxinfo" id="T2:U812"><span class="var type1" id="S90T2U1072">vz</span>    =  <span class="mxinfo" id="T2:U814"><span class="var type1" id="S81T2U1074">sini</span> * <span class="var type1" id="S78T2U1075">cossu</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,274" id="srcline274">274</a></span><span class="line">      </span></span>
<span class="srcline"><span class="lineno"><a href="47,275" id="srcline275">275</a></span><span class="line">    <span class="comment">% position and velocity (in km and km/sec)</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,276" id="srcline276">276</a></span><span class="line">    <span class="mxinfo" id="T22:U817"><span class="var type1" id="S2T22U1078">r</span> = <span class="mxinfo" id="T22:U819">zeros(<span class="mxinfo" id="T2:U820">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,277" id="srcline277">277</a></span><span class="line">    <span class="mxinfo" id="T22:U821"><span class="var type1" id="S3T22U1085">v</span> = <span class="mxinfo" id="T22:U823">zeros(<span class="mxinfo" id="T2:U824">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,278" id="srcline278">278</a></span><span class="line">    <span class="mxinfo" id="T2:U825"><span class="mxinfo" id="T2:U826"><span class="var type1" id="S2T22U1093">r</span>(<span class="mxinfo" id="T2:U828">1</span>,<span class="mxinfo" id="T2:U829">1</span>)</span> = <span class="mxinfo" id="T2:U830">(<span class="mxinfo" id="T2:U831"><span class="var type1" id="S12T2U1099">mrt</span> * <span class="var type1" id="S85T2U1100">ux</span></span>)* <span class="mxinfo" id="T2:U834"><span class="var type1" id="S10T4U1102">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,279" id="srcline279">279</a></span><span class="line">    <span class="mxinfo" id="T2:U836"><span class="mxinfo" id="T2:U837"><span class="var type1" id="S2T22U1107">r</span>(<span class="mxinfo" id="T2:U839">2</span>,<span class="mxinfo" id="T2:U840">1</span>)</span> = <span class="mxinfo" id="T2:U841">(<span class="mxinfo" id="T2:U842"><span class="var type1" id="S12T2U1113">mrt</span> * <span class="var type1" id="S86T2U1114">uy</span></span>)* <span class="mxinfo" id="T2:U845"><span class="var type1" id="S10T4U1116">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,280" id="srcline280">280</a></span><span class="line">    <span class="mxinfo" id="T2:U847"><span class="mxinfo" id="T2:U848"><span class="var type1" id="S2T22U1121">r</span>(<span class="mxinfo" id="T2:U850">3</span>,<span class="mxinfo" id="T2:U851">1</span>)</span> = <span class="mxinfo" id="T2:U852">(<span class="mxinfo" id="T2:U853"><span class="var type1" id="S12T2U1127">mrt</span> * <span class="var type1" id="S87T2U1128">uz</span></span>)* <span class="mxinfo" id="T2:U856"><span class="var type1" id="S10T4U1130">gravc</span>.radiusearthkm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,281" id="srcline281">281</a></span><span class="line">    <span class="mxinfo" id="T2:U858"><span class="mxinfo" id="T2:U859"><span class="var type1" id="S3T22U1135">v</span>(<span class="mxinfo" id="T2:U861">1</span>,<span class="mxinfo" id="T2:U862">1</span>)</span> = <span class="mxinfo" id="T2:U863">(<span class="mxinfo" id="T2:U864"><span class="mxinfo" id="T2:U865"><span class="var type1" id="S75T2U1142">mvt</span> * <span class="var type1" id="S85T2U1143">ux</span></span> + <span class="mxinfo" id="T2:U868"><span class="var type1" id="S76T2U1145">rvdot</span> * <span class="var type1" id="S88T2U1146">vx</span></span></span>) * <span class="var type1" id="S11T2U1147">vkmpersec</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,282" id="srcline282">282</a></span><span class="line">    <span class="mxinfo" id="T2:U872"><span class="mxinfo" id="T2:U873"><span class="var type1" id="S3T22U1151">v</span>(<span class="mxinfo" id="T2:U875">2</span>,<span class="mxinfo" id="T2:U876">1</span>)</span> = <span class="mxinfo" id="T2:U877">(<span class="mxinfo" id="T2:U878"><span class="mxinfo" id="T2:U879"><span class="var type1" id="S75T2U1158">mvt</span> * <span class="var type1" id="S86T2U1159">uy</span></span> + <span class="mxinfo" id="T2:U882"><span class="var type1" id="S76T2U1161">rvdot</span> * <span class="var type1" id="S89T2U1162">vy</span></span></span>) * <span class="var type1" id="S11T2U1163">vkmpersec</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,283" id="srcline283">283</a></span><span class="line">    <span class="mxinfo" id="T2:U886"><span class="mxinfo" id="T2:U887"><span class="var type1" id="S3T22U1167">v</span>(<span class="mxinfo" id="T2:U889">3</span>,<span class="mxinfo" id="T2:U890">1</span>)</span> = <span class="mxinfo" id="T2:U891">(<span class="mxinfo" id="T2:U892"><span class="mxinfo" id="T2:U893"><span class="var type1" id="S75T2U1174">mvt</span> * <span class="var type1" id="S87T2U1175">uz</span></span> + <span class="mxinfo" id="T2:U896"><span class="var type1" id="S76T2U1177">rvdot</span> * <span class="var type1" id="S90T2U1178">vz</span></span></span>) * <span class="var type1" id="S11T2U1179">vkmpersec</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,284" id="srcline284">284</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="47,285" id="srcline285">285</a></span><span class="line">    <span class="comment">% Calculate the GMST1982 angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,286" id="srcline286">286</a></span><span class="line">    <span class="mxinfo" id="T2:U900"><span class="var type1" id="S92T2U1182">TUT1</span> = <span class="mxinfo" id="T2:U902">(<span class="mxinfo" id="T2:U903"><span class="mxinfo" id="T2:U904"><span class="mxinfo" id="T2:U905"><span class="var type1" id="S9T1U1188">satrec</span>.jdsatepoch</span> + <span class="mxinfo" id="T2:U907"><span class="var type1" id="S4T2U1191">tsince</span>/<span class="mxinfo" id="T2:U909">1440</span></span></span> - <span class="mxinfo" id="T2:U910">2451545.0</span></span>)/<span class="mxinfo" id="T2:U911">36525</span></span></span>; <span class="comment">% 1440 minutes in a day</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,287" id="srcline287">287</a></span><span class="line">    <span class="mxinfo" id="T2:U912"><span class="var type1" id="S93T2U1197">TGMST_1982</span> = <span class="mxinfo" id="T2:U914"><span class="mxinfo" id="T2:U915"><span class="mxinfo" id="T2:U916"><span class="mxinfo" id="T2:U917">67310.54841</span> + <span class="mxinfo" id="T2:U918">(<span class="mxinfo" id="T2:U919">876600*3600 + 8640184.812866</span>)*<span class="var type1" id="S92T2U1209">TUT1</span></span></span> + <span class="mxinfo" id="T2:U921"><span class="mxinfo" id="T2:U922">0.093104</span>*<span class="mxinfo" id="T2:U923"><span class="var type1" id="S92T2U1213">TUT1</span>^2</span></span></span> - <span class="mxinfo" id="T2:U925"><span class="mxinfo" id="T2:U926">6.2E-6</span>*<span class="mxinfo" id="T2:U927"><span class="var type1" id="S92T2U1218">TUT1</span>^3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,288" id="srcline288">288</a></span><span class="line">    <span class="mxinfo" id="T2:U929"><span class="var type1" id="S93T2U1222">TGMST_1982</span> = <span class="mxinfo" id="T2:U931"><span class="mxinfo" id="T2:U932">(<span class="mxinfo" id="T2:U933"><span class="mxinfo" id="T2:U934">mod(<span class="var type1" id="S93T2U1229">TGMST_1982</span>,<span class="mxinfo" id="T2:U936">86400</span>)</span>/<span class="mxinfo" id="T2:U937">240</span></span>)*<span class="mxinfo" id="T2:U938">pi</span></span>/<span class="mxinfo" id="T2:U939">180</span></span></span>; <span class="comment">% 1 sec = 1/240 degrees</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,289" id="srcline289">289</a></span><span class="line">    <span class="mxinfo" id="T21:U940"><span class="var type1" id="S95T21U1237">ROT3</span> = <span class="mxinfo" id="T21:U942">[<span class="mxinfo" id="T39:U943"><span class="mxinfo" id="T2:U944">cos(<span class="var type1" id="S93T2U1242">TGMST_1982</span>)</span> <span class="mxinfo" id="T2:U946">-<span class="mxinfo" id="T2:U947">sin(<span class="var type1" id="S93T2U1246">TGMST_1982</span>)</span></span> <span class="mxinfo" id="T2:U949">0</span></span>;<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,290" id="srcline290">290</a></span><span class="line"><span class="mxinfo" id="T21:U940"><span class="mxinfo" id="T21:U942">        <span class="mxinfo" id="T39:U950"><span class="mxinfo" id="T2:U951">sin(<span class="var type1" id="S93T2U1251">TGMST_1982</span>)</span> <span class="mxinfo" id="T2:U953">cos(<span class="var type1" id="S93T2U1254">TGMST_1982</span>)</span> <span class="mxinfo" id="T2:U955">0</span></span>;<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="47,291" id="srcline291">291</a></span><span class="line"><span class="mxinfo" id="T21:U940"><span class="mxinfo" id="T21:U942">        <span class="mxinfo" id="T39:U956"><span class="mxinfo" id="T2:U957">0</span> <span class="mxinfo" id="T2:U958">0</span> <span class="mxinfo" id="T2:U959">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,292" id="srcline292">292</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="47,293" id="srcline293">293</a></span><span class="line">    <span class="mxinfo" id="T22:U960"><span class="var type1" id="S2T22U1262">r</span> = <span class="mxinfo" id="T22:U962"><span class="mxinfo" id="T21:U963"><span class="var type1" id="S95T21U1265">ROT3</span>'</span>*<span class="var type1" id="S2T22U1266">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,294" id="srcline294">294</a></span><span class="line">    <span class="mxinfo" id="T22:U966"><span class="var type1" id="S96T22U1269">w_e</span> = <span class="mxinfo" id="T22:U968">[0; 0; 0.00007292115855300]</span></span>; <span class="comment">% rad/solar second</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,295" id="srcline295">295</a></span><span class="line">    <span class="mxinfo" id="T22:U969"><span class="var type1" id="S3T22U1279">v</span> = <span class="mxinfo" id="T22:U971"><span class="mxinfo" id="T22:U972"><span class="mxinfo" id="T21:U973"><span class="var type1" id="S95T21U1283">ROT3</span>'</span>*<span class="var type1" id="S3T22U1284">v</span></span> + <span class="mxinfo" id="T22:U976">cross(<span class="mxinfo" id="T22:U977"><span class="var type1" id="S96T22U1287">w_e</span></span>,<span class="var type1" id="S2T22U1288">r</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,296" id="srcline296">296</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="47,297" id="srcline297">297</a></span><span class="line"><span class="keyword">end</span> <span class="comment">% // if pl &gt; 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,298" id="srcline298">298</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,299" id="srcline299">299</a></span><span class="line"><span class="comment">% // sgp4fix for decaying satellites</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,300" id="srcline300">300</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T5:U980"><span class="var type1" id="S12T2U1293">mrt</span> &lt; <span class="mxinfo" id="T2:U982">1.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="47,301" id="srcline301">301</a></span><span class="line">    <span class="mxinfo" id="T2:U983"><span class="mxinfo" id="T2:U984"><span class="var type1" id="S9T1U1298">satrec</span>.error</span> = <span class="mxinfo" id="T2:U986">6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,302" id="srcline302">302</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,303" id="srcline303">303</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,304" id="srcline304">304</a></span><span class="line"><span class="comment">% global idebug dbgfile</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,305" id="srcline305">305</a></span><span class="line"><span class="comment">% if idebug</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,306" id="srcline306">306</a></span><span class="line"><span class="comment">%     debug7;</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,307" id="srcline307">307</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="47,308" id="srcline308">308</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="47,309" id="srcline309">309</a></span><span class="line"><span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="47,310" id="srcline310">310</a></span><span class="line"></span></span>
</pre>
