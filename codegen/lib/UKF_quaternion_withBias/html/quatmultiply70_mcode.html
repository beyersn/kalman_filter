<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S101T14U1330">qres</span> = quatmultiply(<span class="var type1" id="S102T14U1333">q</span>, <span class="var type1" id="S103T14U1334">r</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"><span class="mxinfo" id="T15:U4"><span class="var type1" id="S102T15U1337">q</span> = <span class="mxinfo" id="T15:U6"><span class="var type1" id="S102T14U1339">q</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line"><span class="mxinfo" id="T15:U8"><span class="var type1" id="S103T15U1342">r</span> = <span class="mxinfo" id="T15:U10"><span class="var type1" id="S103T14U1344">r</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line"><span class="comment">% Calculate vector portion of quaternion product</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line"><span class="comment">% vec = s1*v2 + s2*v1 + cross(v1,v2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line"><span class="mxinfo" id="T16:U12"><span class="var type1" id="S104T16U1347">vec</span> = <span class="mxinfo" id="T16:U14"><span class="mxinfo" id="T16:U15"><span class="mxinfo" id="T16:U16">[<span class="mxinfo" id="T2:U17"><span class="mxinfo" id="T2:U18"><span class="var type1" id="S102T15U1354">q</span>(:,<span class="mxinfo" id="T2:U20">1</span>)</span>.*<span class="mxinfo" id="T2:U21"><span class="var type1" id="S103T15U1358">r</span>(:,<span class="mxinfo" id="T2:U23">2</span>)</span></span> <span class="mxinfo" id="T2:U24"><span class="mxinfo" id="T2:U25"><span class="var type1" id="S102T15U1363">q</span>(:,<span class="mxinfo" id="T2:U27">1</span>)</span>.*<span class="mxinfo" id="T2:U28"><span class="var type1" id="S103T15U1367">r</span>(:,<span class="mxinfo" id="T2:U30">3</span>)</span></span> <span class="mxinfo" id="T2:U31"><span class="mxinfo" id="T2:U32"><span class="var type1" id="S102T15U1372">q</span>(:,<span class="mxinfo" id="T2:U34">1</span>)</span>.*<span class="mxinfo" id="T2:U35"><span class="var type1" id="S103T15U1376">r</span>(:,<span class="mxinfo" id="T2:U37">4</span>)</span></span>]</span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line"><span class="mxinfo" id="T16:U12"><span class="mxinfo" id="T16:U14"><span class="mxinfo" id="T16:U15">         <span class="mxinfo" id="T16:U38">[<span class="mxinfo" id="T2:U39"><span class="mxinfo" id="T2:U40"><span class="var type1" id="S103T15U1383">r</span>(:,<span class="mxinfo" id="T2:U42">1</span>)</span>.*<span class="mxinfo" id="T2:U43"><span class="var type1" id="S102T15U1387">q</span>(:,<span class="mxinfo" id="T2:U45">2</span>)</span></span> <span class="mxinfo" id="T2:U46"><span class="mxinfo" id="T2:U47"><span class="var type1" id="S103T15U1392">r</span>(:,<span class="mxinfo" id="T2:U49">1</span>)</span>.*<span class="mxinfo" id="T2:U50"><span class="var type1" id="S102T15U1396">q</span>(:,<span class="mxinfo" id="T2:U52">3</span>)</span></span> <span class="mxinfo" id="T2:U53"><span class="mxinfo" id="T2:U54"><span class="var type1" id="S103T15U1401">r</span>(:,<span class="mxinfo" id="T2:U56">1</span>)</span>.*<span class="mxinfo" id="T2:U57"><span class="var type1" id="S102T15U1405">q</span>(:,<span class="mxinfo" id="T2:U59">4</span>)</span></span>]</span></span>+<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line"><span class="mxinfo" id="T16:U12"><span class="mxinfo" id="T16:U14">         <span class="mxinfo" id="T16:U60">[ <span class="mxinfo" id="T2:U61"><span class="mxinfo" id="T2:U62"><span class="mxinfo" id="T2:U63"><span class="var type1" id="S102T15U1413">q</span>(:,<span class="mxinfo" id="T2:U65">3</span>)</span>.*<span class="mxinfo" id="T2:U66"><span class="var type1" id="S103T15U1417">r</span>(:,<span class="mxinfo" id="T2:U68">4</span>)</span></span>-<span class="mxinfo" id="T2:U69"><span class="mxinfo" id="T2:U70"><span class="var type1" id="S102T15U1422">q</span>(:,<span class="mxinfo" id="T2:U72">4</span>)</span>.*<span class="mxinfo" id="T2:U73"><span class="var type1" id="S103T15U1426">r</span>(:,<span class="mxinfo" id="T2:U75">3</span>)</span></span></span> <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line"><span class="mxinfo" id="T16:U12"><span class="mxinfo" id="T16:U14"><span class="mxinfo" id="T16:U60">           <span class="mxinfo" id="T2:U76"><span class="mxinfo" id="T2:U77"><span class="mxinfo" id="T2:U78"><span class="var type1" id="S102T15U1432">q</span>(:,<span class="mxinfo" id="T2:U80">4</span>)</span>.*<span class="mxinfo" id="T2:U81"><span class="var type1" id="S103T15U1436">r</span>(:,<span class="mxinfo" id="T2:U83">2</span>)</span></span>-<span class="mxinfo" id="T2:U84"><span class="mxinfo" id="T2:U85"><span class="var type1" id="S102T15U1441">q</span>(:,<span class="mxinfo" id="T2:U87">2</span>)</span>.*<span class="mxinfo" id="T2:U88"><span class="var type1" id="S103T15U1445">r</span>(:,<span class="mxinfo" id="T2:U90">4</span>)</span></span></span> <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line"><span class="mxinfo" id="T16:U12"><span class="mxinfo" id="T16:U14"><span class="mxinfo" id="T16:U60">           <span class="mxinfo" id="T2:U91"><span class="mxinfo" id="T2:U92"><span class="mxinfo" id="T2:U93"><span class="var type1" id="S102T15U1451">q</span>(:,<span class="mxinfo" id="T2:U95">2</span>)</span>.*<span class="mxinfo" id="T2:U96"><span class="var type1" id="S103T15U1455">r</span>(:,<span class="mxinfo" id="T2:U98">3</span>)</span></span>-<span class="mxinfo" id="T2:U99"><span class="mxinfo" id="T2:U100"><span class="var type1" id="S102T15U1460">q</span>(:,<span class="mxinfo" id="T2:U102">3</span>)</span>.*<span class="mxinfo" id="T2:U103"><span class="var type1" id="S103T15U1464">r</span>(:,<span class="mxinfo" id="T2:U105">2</span>)</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line"><span class="comment">% Calculate scalar portion of quaternion product</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line"><span class="comment">% scalar = s1*s2 - dot(v1,v2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line"><span class="mxinfo" id="T2:U106"><span class="var type1" id="S105T2U1469">scalar</span> = <span class="mxinfo" id="T2:U108"><span class="mxinfo" id="T2:U109"><span class="mxinfo" id="T2:U110"><span class="mxinfo" id="T2:U111"><span class="mxinfo" id="T2:U112"><span class="var type1" id="S102T15U1475">q</span>(:,<span class="mxinfo" id="T2:U114">1</span>)</span>.*<span class="mxinfo" id="T2:U115"><span class="var type1" id="S103T15U1479">r</span>(:,<span class="mxinfo" id="T2:U117">1</span>)</span></span> - <span class="mxinfo" id="T2:U118"><span class="mxinfo" id="T2:U119"><span class="var type1" id="S102T15U1484">q</span>(:,<span class="mxinfo" id="T2:U121">2</span>)</span>.*<span class="mxinfo" id="T2:U122"><span class="var type1" id="S103T15U1488">r</span>(:,<span class="mxinfo" id="T2:U124">2</span>)</span></span></span> - <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line"><span class="mxinfo" id="T2:U106"><span class="mxinfo" id="T2:U108"><span class="mxinfo" id="T2:U109">             <span class="mxinfo" id="T2:U125"><span class="mxinfo" id="T2:U126"><span class="var type1" id="S102T15U1493">q</span>(:,<span class="mxinfo" id="T2:U128">3</span>)</span>.*<span class="mxinfo" id="T2:U129"><span class="var type1" id="S103T15U1497">r</span>(:,<span class="mxinfo" id="T2:U131">3</span>)</span></span></span> - <span class="mxinfo" id="T2:U132"><span class="mxinfo" id="T2:U133"><span class="var type1" id="S102T15U1502">q</span>(:,<span class="mxinfo" id="T2:U135">4</span>)</span>.*<span class="mxinfo" id="T2:U136"><span class="var type1" id="S103T15U1506">r</span>(:,<span class="mxinfo" id="T2:U138">4</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line"><span class="mxinfo" id="T14:U139"><span class="var type1" id="S101T14U1511">qres</span> = <span class="mxinfo" id="T14:U141"><span class="mxinfo" id="T15:U142">[<span class="var type1" id="S105T2U1515">scalar</span>  <span class="var type1" id="S104T16U1516">vec</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line"></span></span>
</pre>
