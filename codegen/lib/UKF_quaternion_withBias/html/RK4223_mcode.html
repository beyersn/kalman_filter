<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S62T28U994">X_kkm1</span> = RK4(<span class="var type1" id="S63T28U997">X_km1km1</span>, <span class="var type1" id="S64T16U998">I_c</span>, <span class="var type1" id="S65T1U999">Torque_c</span>, <span class="var type1" id="S66T2U1000">Ts</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="comment">% This function performs a fourth-order Runge-Kutta integration on the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="comment">% kinematic equation for the satellite to propogate the sigma points</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="comment">% through it's current dynamic behavior to develop a prediction state</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="comment">% X_km1km1 is the quaternion sigma points</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="comment">% w is the angular velocities</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"><span class="comment">% Ts is the descrete sample time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo" id="T28:U6"><span class="var type1" id="S62T28U1003">X_kkm1</span> = <span class="mxinfo" id="T28:U8">zeros(size(<span class="var type1" id="S63T28U1008">X_km1km1</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S69T2U1011">idx</span> = <span class="mxinfo" id="T2:U11">1</span>:size(<span class="var type1" id="S63T28U1016">X_km1km1</span>,2)</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">    <span class="mxinfo" id="T17:U13"><span class="var type1" id="S70T17U1020">k1</span> = <span class="mxinfo" id="T17:U15"><span class="fcn" id="F214N3:B1022">Kinematics</span>(<span class="mxinfo" id="T17:U16"><span class="var type1" id="S63T28U1024">X_km1km1</span>(<span class="mxinfo" id="T45:U18"><span class="mxinfo" id="T2:U19">1</span>:<span class="mxinfo" id="T2:U20">10</span></span>,<span class="var type1" id="S69T2U1028">idx</span>)</span>, <span class="var type1" id="S64T16U1029">I_c</span>, <span class="var type1" id="S65T1U1030">Torque_c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">    <span class="mxinfo" id="T17:U24"><span class="var type1" id="S72T17U1033">k2</span> = <span class="mxinfo" id="T17:U26"><span class="fcn" id="F214N3:B1035">Kinematics</span>(<span class="mxinfo" id="T17:U27"><span class="mxinfo" id="T17:U28"><span class="var type1" id="S63T28U1038">X_km1km1</span>(<span class="mxinfo" id="T45:U30"><span class="mxinfo" id="T2:U31">1</span>:<span class="mxinfo" id="T2:U32">10</span></span>,<span class="var type1" id="S69T2U1042">idx</span>)</span> + <span class="mxinfo" id="T17:U34"><span class="mxinfo" id="T17:U35"><span class="mxinfo" id="T2:U36">0.5</span>*<span class="var type1" id="S70T17U1046">k1</span></span>*<span class="var type1" id="S66T2U1047">Ts</span></span></span>, <span class="var type1" id="S64T16U1048">I_c</span>, <span class="var type1" id="S65T1U1049">Torque_c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">    <span class="mxinfo" id="T17:U41"><span class="var type1" id="S73T17U1052">k3</span> = <span class="mxinfo" id="T17:U43"><span class="fcn" id="F214N3:B1054">Kinematics</span>(<span class="mxinfo" id="T17:U44"><span class="mxinfo" id="T17:U45"><span class="var type1" id="S63T28U1057">X_km1km1</span>(<span class="mxinfo" id="T45:U47"><span class="mxinfo" id="T2:U48">1</span>:<span class="mxinfo" id="T2:U49">10</span></span>,<span class="var type1" id="S69T2U1061">idx</span>)</span> + <span class="mxinfo" id="T17:U51"><span class="mxinfo" id="T17:U52"><span class="mxinfo" id="T2:U53">0.5</span>*<span class="var type1" id="S72T17U1065">k2</span></span>*<span class="var type1" id="S66T2U1066">Ts</span></span></span>, <span class="var type1" id="S64T16U1067">I_c</span>, <span class="var type1" id="S65T1U1068">Torque_c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">    <span class="mxinfo" id="T17:U58"><span class="var type1" id="S74T17U1071">k4</span> = <span class="mxinfo" id="T17:U60"><span class="fcn" id="F214N3:B1073">Kinematics</span>(<span class="mxinfo" id="T17:U61"><span class="mxinfo" id="T17:U62"><span class="var type1" id="S63T28U1076">X_km1km1</span>(<span class="mxinfo" id="T45:U64"><span class="mxinfo" id="T2:U65">1</span>:<span class="mxinfo" id="T2:U66">10</span></span>,<span class="var type1" id="S69T2U1080">idx</span>)</span> + <span class="mxinfo" id="T17:U68"><span class="var type1" id="S73T17U1082">k3</span>*<span class="var type1" id="S66T2U1083">Ts</span></span></span>, <span class="var type1" id="S64T16U1084">I_c</span>, <span class="var type1" id="S65T1U1085">Torque_c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">    <span class="mxinfo" id="T17:U73"><span class="mxinfo" id="T17:U74"><span class="var type1" id="S62T28U1089">X_kkm1</span>(<span class="mxinfo" id="T45:U76"><span class="mxinfo" id="T2:U77">1</span>:<span class="mxinfo" id="T2:U78">10</span></span>,<span class="var type1" id="S69T2U1093">idx</span>)</span> = <span class="mxinfo" id="T17:U80"><span class="mxinfo" id="T17:U81"><span class="var type1" id="S63T28U1096">X_km1km1</span>(<span class="mxinfo" id="T45:U83"><span class="mxinfo" id="T2:U84">1</span>:<span class="mxinfo" id="T2:U85">10</span></span>,<span class="var type1" id="S69T2U1100">idx</span>)</span> + <span class="mxinfo" id="T17:U87"><span class="mxinfo" id="T17:U88">(<span class="mxinfo" id="T17:U89"><span class="mxinfo" id="T17:U90"><span class="mxinfo" id="T17:U91"><span class="var type1" id="S70T17U1107">k1</span> + <span class="mxinfo" id="T17:U93"><span class="mxinfo" id="T2:U94">2</span>*<span class="var type1" id="S72T17U1110">k2</span></span></span> + <span class="mxinfo" id="T17:U96"><span class="mxinfo" id="T2:U97">2</span>*<span class="var type1" id="S73T17U1113">k3</span></span></span> + <span class="var type1" id="S74T17U1114">k4</span></span>)*<span class="var type1" id="S66T2U1115">Ts</span></span>/<span class="mxinfo" id="T2:U101">6</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="keyword">end</span> <span class="comment">% End of for</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"></span></span>
</pre>
